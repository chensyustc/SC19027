<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Chen Shuyue" />

<meta name="date" content="2020-01-02" />

<title>All Homework Answers</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All Homework Answers</h1>
<h4 class="author">Chen Shuyue</h4>
<h4 class="date">2020-01-02</h4>



<div id="hw-2019-09-20" class="section level1">
<h1>HW-2019-09-20</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<ul>
<li>example 1:R code</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>a =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>,<span class="dt">mean=</span><span class="dv">5</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>m =<span class="st"> </span><span class="kw">mean</span>(a)</span>
<span id="cb1-3"><a href="#cb1-3"></a>s =<span class="st"> </span><span class="kw">sd</span>(a)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">c</span>(m<span class="op">-</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span>s<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">50</span>),m<span class="op">+</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span>s<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">50</span>)) </span></code></pre></div>
<pre><code>## [1] 4.463580 5.030031</code></pre>
<p>This example of R code shows the calculation of 95% confidence interval for the mean of the normal distribution.</p>
<ul>
<li>example 2:tables</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(airquality,<span class="dt">n=</span><span class="dv">10</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Ozone</th>
<th align="right">Solar.R</th>
<th align="right">Wind</th>
<th align="right">Temp</th>
<th align="right">Month</th>
<th align="right">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">41</td>
<td align="right">190</td>
<td align="right">7.4</td>
<td align="right">67</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">118</td>
<td align="right">8.0</td>
<td align="right">72</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">149</td>
<td align="right">12.6</td>
<td align="right">74</td>
<td align="right">5</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">313</td>
<td align="right">11.5</td>
<td align="right">62</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">14.3</td>
<td align="right">56</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">28</td>
<td align="right">NA</td>
<td align="right">14.9</td>
<td align="right">66</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">23</td>
<td align="right">299</td>
<td align="right">8.6</td>
<td align="right">65</td>
<td align="right">5</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">99</td>
<td align="right">13.8</td>
<td align="right">59</td>
<td align="right">5</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">19</td>
<td align="right">20.1</td>
<td align="right">61</td>
<td align="right">5</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">194</td>
<td align="right">8.6</td>
<td align="right">69</td>
<td align="right">5</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>This is a table of daily airquality in New York from May 1st to 10th,1973.</p>
<ul>
<li>example 3:plots</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">9</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">plot</span>(x,y,<span class="dt">asp=</span><span class="dv">1</span>,<span class="dt">type=</span><span class="st">&quot;p&quot;</span>)                                  </span>
<span id="cb4-4"><a href="#cb4-4"></a>lmout &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)                                                  </span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw">abline</span>(lmout)  </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This example shows the regression curve of x and y.</p>
</div>
</div>
<div id="hw-2019-09-29" class="section level1">
<h1>HW-2019-09-29</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.18 (pages 94-96, Statistical Computating with R).</p>
<ol style="list-style-type: decimal">
<li>Exercises3.4</li>
</ol>
<p>The Rayleigh density is <span class="math inline">\(f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)},\quad x \geq 0,\sigma&gt;0.\)</span>Develop an algorithm to generate random samples from a Rayleigh(σ) distribution. Generate Rayleigh(σ) samples for several choices of σ &gt; 0 and check that the mode of the generated samples is close to the theoretical mode σ (check the histogram).</p>
<ol start="2" style="list-style-type: decimal">
<li>Exercises 3.11</li>
</ol>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0,1) and N(3,1) distributions with mixing probabilities <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}=1-p_{1}\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_{1}=0.75\)</span>. Repeat with different values for <span class="math inline">\(p_{1}\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_{1}\)</span> that produce bimodal mixtures.</p>
<ol start="3" style="list-style-type: decimal">
<li>Exercises 3.18</li>
</ol>
<p>Write a function to generate a random sample from a <span class="math inline">\(W_{d}(\Sigma, n)\)</span>(Wishart) distribution for <span class="math inline">\(n&gt;d+1 \geq 1\)</span>, based on Bartlett’s decomposition.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="exercises-3.4" class="section level3">
<h3>1. Exercises 3.4</h3>
<ul>
<li>We use acceptance-rejection algorithm to generate random samples from a Rayleigh(σ) distribution.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">#function of Rayleigh(σ) distribution.</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>f&lt;-<span class="cf">function</span>(x,s) x<span class="op">/</span>(s<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>s<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#function of random samples from a Rayleigh(σ) distribution.</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>samp4&lt;-<span class="cf">function</span>(n,s){</span>
<span id="cb5-5"><a href="#cb5-5"></a>  x&lt;-<span class="kw">rnorm</span>(n,s,s)</span>
<span id="cb5-6"><a href="#cb5-6"></a>  y&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span><span class="kw">dnorm</span>(x,s,s))</span>
<span id="cb5-7"><a href="#cb5-7"></a>  z&lt;-x[y<span class="op">&lt;</span><span class="kw">f</span>(x,s)]</span>
<span id="cb5-8"><a href="#cb5-8"></a>  z</span>
<span id="cb5-9"><a href="#cb5-9"></a>}</span></code></pre></div>
<p>Then we generate Rayleigh(σ) samples for several choices of σ &gt; 0 and check that the mode of the generated samples is close to the theoretical mode σ (check the histogram).</p>
<ul>
<li>for σ=0.5</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>samp&lt;-<span class="st"> </span><span class="kw">samp4</span>(<span class="dv">10000</span>,<span class="fl">0.5</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>]</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">hist</span>(samp, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.05</span>),<span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for σ=0.5&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,<span class="fl">0.5</span>),<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">3</span>, <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>for σ=1</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>samp&lt;-<span class="st"> </span><span class="kw">samp4</span>(<span class="dv">10000</span>,<span class="dv">1</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>]</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">hist</span>(samp, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.05</span>),<span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for σ=1&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,<span class="dv">1</span>),<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">5</span>, <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>for σ=1.5</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">14</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>samp&lt;-<span class="st"> </span><span class="kw">samp4</span>(<span class="dv">10000</span>,<span class="fl">1.5</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>]</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw">hist</span>(samp, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="fl">0.1</span>),<span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for σ=1.5&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,<span class="fl">1.5</span>),<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">7</span>, <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>for σ=2</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">set.seed</span>(<span class="dv">22</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>samp&lt;-<span class="st"> </span><span class="kw">samp4</span>(<span class="dv">10000</span>,<span class="dv">2</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>]</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw">hist</span>(samp, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>),<span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for σ=2&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,<span class="dv">2</span>),<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">10</span>, <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAw1BMVEUAAAAAADoAAGYAAIsAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa225C227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb2//b////AAD/tmb/25D/27b//7b//9v///8gYLucAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANn0lEQVR4nO1daWPjthUcm7VrbZ2jUnZ7RJu0aWtu09btKtm0Xtoy//+vKgEQJCURFw+9kez5IIMk+DAc4iLwAKN8hReQJsAOSBNgB6QJsAPSBNgBaQLsgDQBdkCaADsgTYAdkCbADkgTYAekCbAD0gTYAWkC7IA0AXZAmgA7IE2AHZAmwA5IE2AHpAmwA9IE2AFpAuyANAF2QJoAOyBNgB2QJsAOSBNgB6QJsAPSBNgBaQLsgDQBdkCaADsgTYAdCEfZ4OKuDj6/x/XDzsXnv3+cmNHzhwXw9dCbDwiOMfn0DkA4mk+gp7eXUwtUVKSwHHhzv0ADTRYLpAp0gByTC+RLLoh+gYaZrGxd3kUWsb99AK7umvR/ugUuvrpX+lRQEn2qMuOvfq+pPeu4Wrnqzh/e4vK+/PS2ivdFZWC7ws2nW1x8W/600BYtGgPapH2eJqHSZ6JK65/V7Vf3DUHF4eJrq1RjsmXZMDNS/KjzispmjzZ0cbd9t7iJrIMMqic26W+aYytQfUZze6/N37anrx8Km6Z6OoNbK+1OGpWBrkBtQqXPRN48U02wjnL1cVegDstNEyot5QOBzM1xAl3fq9+lSV+9wofyZ12qTRGrrBrdlvpJbh6ec6tbded/q7t+/aAiLTX1pboX39bxNboG2vLQSchrQiV2r87c1ALl6lhHbsrA3X4imlnzgMvyqVJprSMNEWit2dYCVTau/lXal2Neoc4LuclUKlzFNgKt64i//HirHqA6b97w9UP3CboGWoG6CflM5CYZdbd9g0vN2+ZQY3I3kYaZfg8mtZvDh99GCXRRF30jkMmRpiznbcEzEW1451mfvzdv5aYmY35bgboGOgJ1E/KZqJ+8Sf4gF2za0neQSMOjt35/Wg0QqGrbTfJ/rbnVr0CVrrUNdwVSD3r1519WToG6Brrc24S8JmqB1N2aYIE+gVyJKCPrRqBdcdXRAIEq5n+6tVVqRA4yj7F1C+R8uU1CXhM9OWh9+AQROehmrw7SB4MEUva+a2scdx2kaRS2+ls6BHLUQZ2EvCZ66qDd2qSvDmoTaeug5a5Aqjm4HiBQRfa3upzpNmG/fdhtxWwOun5QrYQrBzlasU5CXhM9rVjVS3paNS+zrxXrvAXbiu33eXOVdwcIVH5oM2EBfz+oqYO8lXS3H9Tl3ibkNWH7QU1pr/tBjZ3aZH8iDb/93nadmQYIVP6sKoYvVDdUd5vv6z7qH0xy1akv7w9asau/qGbXJVDHQJd7JyGPiSqt/1SXv2p70k/fL8zxjkCOROqe9Bf35S5qPcMCDULe9000W1qTfxC2wNQGcz2w0N/rmgmnJZDthIz4JE/FaQlUPr1bNJ/gx8GJCXRmgDQBdkCaADsgTYAdkCbADkgTYAekCbAD0gTYAWkC7IA0AXZAmgA7IE2AHZAmwA5IE2AHpAmwA9IE2AFpAuyANAF2QJoAOyBNgB2QJsAOSBNgB6QJsAPSBNgBaQLsgDQBdkCaADuQFNv6Mc04F84GpETeWI+nYvBqk5MDEuI+v29d5o7nHiUMJMTdrhrv2uLFFDIkxJ0oB2VZNvje4wMpkTfWQXtUHZSVZytQsxRpVA10zgKNhipdrwJ58CIEKka4sGYKZyxQrhYtfvnQbfDToNQ5Y4FytVDELHsYWE2ft0A63zy+0SucBnYUlTqfK5Qn0xdCQtztSi88+185Kgd9NjhHgcqNzTdGqo6VBgELdfbRv6cBJMXemOargKuODpkzeSczgaSkpYDjmjO1T1ZnpVMoZjiqOZ19jEBZdhp5CMNu2zhaMY85Uz9ntqXXzdmwxI8KHM2czjJWHdOf1sfkwNHMKYE62ccIxF8N4Wjmst3ypQTKzk6g4KyGx9znHoFOoBpCSuTwrIbHnCpgZy5QxJi005ypgQ4EKukVQkLciFkNpzlTA/UJRK4QEuKOykEOgTL2ph4pkcOzGk5zpgvUI1BJ3pIhKXZwVsNp7oUI5LQSGu6wH6k9AplrtOUMNnCwK9E4c3uwIhwK1DZvnEAbVNvBjHXagOO8Owdl5ckIVE6gERznfQLZbxBOYO94M849at+cxZkIpLa2WVfdneFT7+g/3QyU9QqUMc9yoAnpPd+0MiOcf9B/OigQb28RNrBdTbElEnrPZgGBmLvTsIHtN0afcb5j6D3bjCQ6BGIeGIINWIFco82J5nZwBgLlbV94+ma+HWp1CsQ77AEbsDloInNdnIdAM5p7FShgLkYg2sFX6N/tatlsFT99JZ0gEN9XPeY315nN8AhkGrKMzrkK01jxjQedi0DK52cz0gV6TA7S9TSzQLna1vqmzN3DZsZtqkicOGwn5E9bIDWnoxyjPJ8aWiA9n+H0csXhqXMSKFebZPsFqqVJmPaJFqgeex35QFMDTSi/2a7Uhvn+Iva40ALFTxzuuHT4BKq/6XkFqjpC6t8ueEbuB+WgaIHqhoxXoDBMX/KmPPRy9Zh7SQKVdTbzLBc7MKdr3liBzAQHF9CEJlnRjP0TZyRQPsUyVOyfOB+BnNXKMHM19CdovECEI4uwgcErnPrNadQeZOchkLeBN2hGRNw1FXaOsv05+aBAfMNCaELuBRgNnt+H6insHLXz7mcgUNSAWTCbYedogEB0Y69Ii+7IZo7xoBcoUJq5bOdLNVYgLoXQBvU/nszHNfbYOTrw3IwQiK0hQxMqLu426mt+wonDQQKR1dOwAeXjq77R46aeo5ZDZUMFYlIINqA6ikqgCZ0XBgrEVU/DBmwOykeN2qN7kB34/sYJRFUNoQmZOmgT7i7GmSvPTiDTVfR7UaUthxosEFM9jZTIicuhDj03IwViqoWQEDd1McsYgWgUgg2YbzFvDZ26HGq4QERlDPXf3FTOG5+D2fFyEFEtBPOnsJVzPe/Vj8TlUOMEIvGEgf7tDGN45uZTl0ONEYhmeBr6t/MFNsjLtX+446wEmmiPTXTCPd7jSQJx9BahfwkFMusT5DWC/mUUiGQiGvqXUqB6SmQEmykA/RsxoZNiTqNv/UG6QOJ5CLOZm0IggkKG2cyNFyj7TLAgGnOZ6/UeTxTIbsk0Lcc0YC5zkwhEUMowlznTixkrkHxbj7nMTZOD5D85MJe56QSS/eTAXOamEigTVghzmZtMIOE5DsxlbjqBZIfwMY2V/fGg7p6AEwhkFMokchKCMbqInhebVCA7W88vUPy82LQC1QrRC5QwqzGxQKXcNu8IxmiRMC/mWAM1WCCz/TS7QAk5aHKBMqn+EIIxOoifF5teoFJoEx0EY3QRPS82h0BmQ/xja4RgjCHmXIvExglU/0uFaRlHPtHE5mYSqP6nHNNSjnuiSMR2FGcTKKv/bcmYR04DUiJHdxTnE6jV6EgiISFudDO/u/f41AIdVyMkxI3uKM4uUGaro/mFQkJclhyU2aPPgzCfQO6O4u5wh+6tHBM0Ak3zXzJPC5AmwA5IE2AHht02bjvKUwJmMUoNBoHGXR93eezt46JPYzRwfdxlUYEiN0AJGQ1cH3dZUqDwx2qc0cD1cZcFBYr41IgzGrg+7rKgQNG+sCGjgevjLr/moHmtj4oentWIMxq4Pu6yaCsW+bEaMhq4Pu7yKfSDzgmQJsAOSBNgB6QJsAPSBNgBaQLsgDQBdkCaADsgTYAdkCbADkgTYAekCbAD0gTYgcktFv5trPSwtn8rQt82ao8LeP9hrvovn87tWR5/8zGC4S4QGzEWah+Zwp3+8/vq2sb7jIVnNKWoLvn+ccNGbyjvUGi70uOgAYZ7QGS8WJhRR/cWMmb7Hd/ErN4Q1GvdfbfZxcaRemFmY0IM94DIeLEIC6Dge4Gb6++cAj2+8b94n0AFlnokPY5hA8RFi4Z5hND+Fp798ysD7jqouPz3yluDeYuYoRXHsAHiokXD5I1AEfcMaasC4BZoowqJd1NrbwWsVYli2AJx0aIRk3zhqaP9m4FuLgJvX2XNx4VLfgaBIjKwb0pE3+4RSNt177MWqF8Yili4CvRutLepXVQcCpjHclfVgdzBUEkHG9GIzWLdOcjM7brfvnl45/WCoJkPdcPcFUQLT09aVVGdCd7DW8N1kHBHUZcSXy/HFCEvP9+nRhH4UMl91+us5We4B8RGfKmANAF2QJoAOyBNgB2QJsAOSBNgB6QJsAPSBNgBaQLsgDQBdkCaADsgTYAdkCbADkgTYAekCbAD0gTYAWkC7IA0AXZAmgA7IE2AHZAmwA5IE2AHpAmwA9IE2AFpAuyANAF2QJoAOyBNgB2QJsAOSBNgB6QJ7EO50msfq9z8fVz8UTm2qtPr8vHND4uQn/7EwDETi4D2EVOOvMoFTPlsPi60a/7lR+U1V8m09rj5zgEcMa0YWPe57Td3Ri3tL1b/rI3zmH/jkImB4yUVhXo9hUahS9ViXTY/tQ9ivH/YeOB4ScVBrwZaaz+5y38s9gV6k+TjPAVwvKTikV/cNbq8CtSD7WptnOIPi5h24X3JdZDOHYXJQdtV1aLvCeRdrDIHcMS0olDUTsLaV7db1oxAv1t4VhTOARwzsdFwr9KYDTh2gqPwKlAArwLxAdIE2AFpAuyANAF2QJoAOyBNgB2QJsAOSBNgB6QJsAPSBNgBaQLsgDQBdkCaADsgTYAdkCbADkgTYAekCbAD0gTYAWkC7IA0AXZAmgA7/g8pVH9IADCgQwAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From the result,we find that the mode of the generated samples is close to the theoretical mode σ by checking the histogram.</p>
</div>
<div id="exercises-3.11" class="section level3">
<h3>2. Exercises 3.11</h3>
<ul>
<li>function of the random sample of the normal location mixture distribution</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>samp11 &lt;-<span class="st"> </span><span class="cf">function</span>(n,p){  </span>
<span id="cb10-2"><a href="#cb10-2"></a>  s &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">10000</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="op">-</span>p)                    </span>
<span id="cb10-3"><a href="#cb10-3"></a>  S &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">3</span><span class="op">*</span>s)                 </span>
<span id="cb10-4"><a href="#cb10-4"></a>  S  }</span></code></pre></div>
<ul>
<li>Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_{1}=0.75\)</span>.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#the real density</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>f11 &lt;-<span class="st"> </span><span class="cf">function</span>(x,p) p<span class="op">*</span><span class="kw">dnorm</span>(x,<span class="dv">0</span>)<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span><span class="kw">dnorm</span>(x,<span class="dv">3</span>) </span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#random sample for p=0.75</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw">set.seed</span>(<span class="dv">2235</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a>F11&lt;-<span class="kw">samp11</span>(<span class="dv">1000</span>,<span class="fl">0.75</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a>SAMP&lt;-F11[F11<span class="op">&gt;-</span><span class="dv">3</span><span class="op">&amp;</span>F11<span class="op">&lt;</span><span class="dv">6</span>]</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#Graph the histogram of the sample with density superimposed</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw">hist</span>(SAMP,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">6</span>,<span class="fl">0.2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for p1=0.75&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span>(<span class="op">-</span><span class="dv">3</span>)<span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="kw">curve</span>(<span class="kw">f11</span>(x,<span class="dt">p=</span><span class="fl">0.75</span>),<span class="dt">from=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">to=</span><span class="dv">6</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then we try different values of <span class="math inline">\(p_{1}\)</span>.</p>
<ul>
<li>for <span class="math inline">\(p_{1}=0.15\)</span></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">#random sample for p=0.15</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>F11&lt;-<span class="kw">samp11</span>(<span class="dv">1000</span>,<span class="fl">0.15</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>SAMP&lt;-F11[F11<span class="op">&gt;-</span><span class="dv">3</span><span class="op">&amp;</span>F11<span class="op">&lt;</span><span class="dv">6</span>]      </span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#Graph the histogram of the sample with density superimposed</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="kw">hist</span>(SAMP,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">6</span>,<span class="fl">0.2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for p1=0.15&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span>(<span class="op">-</span><span class="dv">3</span>)<span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="kw">curve</span>(<span class="kw">f11</span>(x,<span class="dt">p=</span><span class="fl">0.15</span>),<span class="dt">from=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">to=</span><span class="dv">6</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAzFBMVEUAAAAAADoAAGYAAIsAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmZgBmZjpmkJBmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa225C227a229u22/+2/9u2///bkDrbkGbbtmbbtpDb27bb29vb////AAD/tmb/25D/27b//7b//9v///+TN9aYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMIElEQVR4nO2dCX/bthnG6aB2J7Ve10zO0l2V13brZmZHnTBNZ8m2+P2/U3GSoETiAQmAh/w+PyeUeLwA/gJeHATBrCQ5lU0dgbmLAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBAx4CK7OJOfzzcZlcPjYOHf3+IHPzh3TrLXg+9+CSCA0zmpzYO77Ls4i96bx9AT29fxQa0z7g2Ay9uB9TLpGBxbIObFVqpbw5AJ8qz6IBcwUG1A+pj8tPb7BQQN/Bj+THLtvJbC6B/caqXd1X4H695hvv6XvDhEog+fZNln6kseJDnSnL8yn+8zV7dq1C/4gaeb7LVp+vs4tvy41parOJlDEiTJj1VQKXLBA/rf/zyy/sqgrJEvDaprEzWsaxiVjav5weyi7W08bjOlC7uuNWVtL3qAKTEU6zCL6rvBpDeI+Mmc+PFdb376mFvQhKpU7o2aBthcAM2oDqg0mUir1KiI6hPufzQBGTFsqg+lY3r+YHLn26PAXF7m7L2TS2Aru7F/xsVvvgJH8qfZalWRexxrbltZEpWD4fccONX/p9f9ZsHcdJGRn0jrs2+1edL2Qbq8mAF5DQhArsXe1YaUC6+y5OrMnB3HIiMWQXQXF9+fP1wOAGkTRl/0gJoK2OrAfHTL3+qcq/6CeWVucpU4jM/WwHa6hN/+c+1iADfr37hqwc7BbaBGpAdkMtEroIRV5tfcCPjbXKoMtkMpIpZ43rx9dSPQUAXuuira1UhUmU5rwueOtF8bqT18H2mawFpRf9fA7INWIDsgFwmdMSr4K3f3kpBRyBl4/oogHjdroL/p75GRVaWrq35bAMSCb38+y83nYBsA3bc64CcJnTExdUygtpfHQHqCqRxvQWoTxE7AsRj/sO1cakeOUjZf+4G1P3jmoCcJlpy0PY0BX1zUB8nfQJImPmu9jjdPkgGqX4a42FbAHX4ICsgp4kWH7RqSUFnIO0+qFnN8z2Oar4JiEf297KcyTrhuH5o1mImB109PN12+6COWswKyGmipRbjraSnm+rHbKvFmoCqWqxsbWwWstklOIqDMAe9q0v4HrSDKh/kdNJ2O8iOex2Q04Rpx1SlXbeDKjvaZHsgjes7ANVdDS9A5c/CMXwlGp6y2Xyv26h/Vcb4rt/dn9Rilz+KarcLkGXAjrsVkMMED+s9P/x13ZJ++n6tvjcAdQRiX98BSHZ3ZWe1DdAgtfSIkym0Q9j3+jBAuRxY4D/tCp8bScsCZBohAV3yvloWoPLpm3XVBR9HCwN0/iJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgIYAe11t80rmoD6BqwmCWBd57WZB65aC9ur9OOahTzzdqMg0B6lR+cUeAnCqyDQFy6nH9GQFy6nCbESCS0UBABbWD+lmpFMXcnBQ5RQRoXHMzUL8UmRnMnR7ohQMqzFznfddDoS8b0OG2nizfMTH6ZQN6vqkaiPuOQvayAVEOQipMH4N8UIfMmGLnoxkvHdDY5mag5QJiQumDWTAg/S+xFg4ofSZaOKD0mWjRgHY7AtQttpNiiYNZKCDue3ZaiUNaKqByp8qXyENJHfVSAamsw0oJiiUMaaGAtPNhChVLGNJiAdXVfFo/tExApn5nVW2fTIsEtGsCSkpooYAYAXJpEkAnCxX1sjLqnVXloflfDSgdIStFYsWdoauGtphLpxNAbBxAZQRGYwDSHpr/1Zt0hNpW4gyYuTEOINm54H+jAxKr3YiVu4YvlzQCINPHYI1NMkJ1isQdC0Wm665gL3PJ1AZI9O0T9VmtWizGKknJATHWnYNYigBrQG8Un4DsU44BqO6lltMACptcNxkglmrUQ6cor5t6863m5Z2wiQDVOSiSuRRiZXOco7lJNCy0pL4YKwmQU+x4IKi5SdMUUil6vtlUD4PN10mz6QDN1VxTjAC5xaYFxIuZfH+Aqx9WZHql867WUmJAxyNlbExAuVjpelXmjmGzQq4WL06YI6A0hKy+2Jb35reuroaaxCk7+9MAOh0pGxlQLtbN7gZkpgHzvDZLQEkGFq0ithKP7KoS1K5qGnC+mgRQ21DiiIB4Q0i8EsA1cm+wqNcguM0lkAcgFj3QfikyE6UPt7MElMILLakdNDEg+KhTP3MJhAElIGQ56T5kpnDS7WOtzY1kGHV02qrmA0bKRrmz6gNIDt6rb5HUaAdFNBddnUOJ5REg8y2SqhS5K/je5qJrckCyn4E04TOr3UOJIwHyGTCb6plVNVg/MSAPTfbEIXMPBDU2VYc/khbxzCqbByD5LsrcUdlPmIPcA0GNTeR7rJaTvrgrRG/eQWiqZ1ZnAUhkj8IxFCY10TOrswAkHIwANMfJC70AmQZBJJ3koDzoZXOJAKGhxDEAaR9UhC2/dc6AlIMJnEWVBpDHOIe1SQZohua0+gGKO/K6BEBe4xxlakCqBg99HegsAEUdVzQpyvUt5cC59mcLaG+cc+AypCkA+Q0ElUkBWaNlrnvzvubiqj+gmISqCVRmx+xmuXoOBJWJAcGBjD7mYmpHgNzyHgh6eYDU/S3zEAbrxSkeoTkDUhUSG5CDEgCK9L6D2IB2AwHFK2RxUpTkziqrPDQr+wKK192YY19Mr05WLWAyJAdFy0KzBFRW5askQC1ipQFkPg3YxHpUfL6ABrUQrc25A5KLS1XeaAinOIRmB0giMauTsXJ4DmJxCtmsANULkw2u3+3NWQHaNaVTyf9CNjEIzQFQCxkCZKle7Y+VdfICvHO9UTMWgzQ1oCrbCLHyKJUnO3oDMqYHa1pAJvMw9ZWV0QEFd8kmBbTb2Su5tIz7nOzouwmv6icDVK/EyrpTCQ67N3q8bUAqbPUDFG+Wa11nyQR1+OSTHf03oYR6AYo2y7VZthLlIAMojNAks1x3vgMZ4LDXJpDQ+LNcrbIFh+PBYT9XFEZo3BxkOlu+yfM7C22CVp3u6YPCZrnqmovhrBMVEAtZmLtfLRY0y9WrYk8CKCQTjdQO2lV0+N8EgPQQU8QUDVSLOaunPiBdsQBZQ03BKfKR+5FMe9yrhjOgg97rZGiIjQjo2ErzxmGTDZuZpgB0xiJAQJE7q+enyJ3V81PkroY2OmulA+Q9zerU6MmeIackMutWmhyE95wlII/OapfRFwIId1a7jL4UQIONEiBglAABowQIGCVAwCgBOlsRICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQUBJAhc9KVo9fuu8+ouMeoagR4rBFfFMAElM/9ojQ84379iw67hPK4xfh70xLAEiulIJWX96D+9fouFcoYYskKKXyQSjq2cYZe3TcL5QiwhLZqQAV0AkhAD6AQCj5b7Pg11enAbT3iFc4IBSKeNMMpzTDRcfK0uN9yDFykM9blwMdUbJ2EKzGYgDCocxsVTbrdexd8apOiQLII/WBdX2CHKQiDdMXCMgjFM+IuJWiiIkFha2pMh0KzUEeocgV/ebopMWLkWHWDy5iHqF4RcQt6qwCESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgQ0M0By4q65KZ+reTKHWz2lZi9WfMjV2g8RZh/6aV6A9nKqQa5mRT1+8SeJigNS88jyrHoXtZpdN4bmBUi9gVLPXS1e/VdO8Dncfv5GEHv+wx/rl3V7TC2Lo1kBaszq5V/Ud/6/nOOzv/quBhQ4sc5fswLEi1hNSOQROc2XA9qr6ar5S89BImNUPlqQMNPpxXMbz2/ucssHjeWlZwaolD5Z5I7HtShWOacly9qWl7CHvK7FRltkbn6ASoWl0EuybaVnKlZirqFVxEbTrAAZz8sdjPbXoiiJj49fvv/bHQEytdj+1QfjhAvF6nD7Z+6GXjwg1VaWS8gZDtwVSWy5qN8IkOpq8MxTN3PyV+8FINnGJkAzFAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgH4FSwG/WvzLQbEAAAAASUVORK5CYII=" /><!-- --></p>
<ul>
<li>for <span class="math inline">\(p_{1}=0.25\)</span></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#random sample for p=0.25</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">set.seed</span>(<span class="dv">2334</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>F11&lt;-<span class="kw">samp11</span>(<span class="dv">1000</span>,<span class="fl">0.25</span>)</span>
<span id="cb13-4"><a href="#cb13-4"></a>SAMP&lt;-F11[F11<span class="op">&gt;-</span><span class="dv">3</span><span class="op">&amp;</span>F11<span class="op">&lt;</span><span class="dv">6</span>]      </span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#Graph the histogram of the sample with density superimposed</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="kw">hist</span>(SAMP,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">6</span>,<span class="fl">0.2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for p1=0.25&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span>(<span class="op">-</span><span class="dv">3</span>)<span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="kw">curve</span>(<span class="kw">f11</span>(x,<span class="dt">p=</span><span class="fl">0.25</span>),<span class="dt">from=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">to=</span><span class="dv">6</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>for <span class="math inline">\(p_{1}=0.5\)</span></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">#random sample for p=0.5</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">set.seed</span>(<span class="dv">2346</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>F11&lt;-<span class="kw">samp11</span>(<span class="dv">1000</span>,<span class="fl">0.5</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>SAMP&lt;-F11[F11<span class="op">&gt;-</span><span class="dv">3</span><span class="op">&amp;</span>F11<span class="op">&lt;</span><span class="dv">6</span>]      </span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#Graph the histogram of the sample with density superimposed</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="kw">hist</span>(SAMP,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">6</span>,<span class="fl">0.2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for p1=0.5&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span>(<span class="op">-</span><span class="dv">3</span>)<span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="kw">curve</span>(<span class="kw">f11</span>(x,<span class="dt">p=</span><span class="fl">0.5</span>),<span class="dt">from=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">to=</span><span class="dv">6</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>for <span class="math inline">\(p_{1}=0.65\)</span></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">#random sample for p=0.65</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>F11&lt;-<span class="kw">samp11</span>(<span class="dv">1000</span>,<span class="fl">0.65</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>SAMP&lt;-F11[F11<span class="op">&gt;-</span><span class="dv">3</span><span class="op">&amp;</span>F11<span class="op">&lt;</span><span class="dv">6</span>]      </span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#Graph the histogram of the sample with density superimposed</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="kw">hist</span>(SAMP,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">6</span>,<span class="fl">0.2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for p1=0.65&quot;</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span>(<span class="op">-</span><span class="dv">3</span>)<span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="kw">curve</span>(<span class="kw">f11</span>(x,<span class="dt">p=</span><span class="fl">0.65</span>),<span class="dt">from=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">to=</span><span class="dv">6</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>for <span class="math inline">\(p_{1}=0.85\)</span></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">#random sample for p=0.85</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>F11&lt;-<span class="kw">samp11</span>(<span class="dv">1000</span>,<span class="fl">0.85</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>SAMP&lt;-F11[F11<span class="op">&gt;-</span><span class="dv">3</span><span class="op">&amp;</span>F11<span class="op">&lt;</span><span class="dv">6</span>]      </span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#Graph the histogram of the sample with density superimposed</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="kw">hist</span>(SAMP,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">6</span>,<span class="fl">0.2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">border=</span><span class="st">&quot;darkblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;histogram of sample for p1=0.85&quot;</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span>(<span class="op">-</span><span class="dv">3</span>)<span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="kw">curve</span>(<span class="kw">f11</span>(x,<span class="dt">p=</span><span class="fl">0.85</span>),<span class="dt">from=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">to=</span><span class="dv">6</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>conjecture about the values of <span class="math inline">\(p_{1}\)</span> that produce bimodal mixtures</li>
</ul>
<p>From the histogram of the sample,we can find that the distribution of mixtures is bimodal.When <span class="math inline">\(p_{1}\)</span> is smaller than 0.5,the peak on the right is higher.And the smaller <span class="math inline">\(p_{1}\)</span> is,the bigger difference between the two sides is.When <span class="math inline">\(p_{1}\)</span> is bigger than 0.5,the peak on the left is higher.And the bigger <span class="math inline">\(p_{1}\)</span> is ,the bigger difference between the two sides is.</p>
</div>
<div id="exercises-3.18" class="section level3">
<h3>3. Exercises 3.18</h3>
<ul>
<li>function of the random sample from a <span class="math inline">\(W_{d}(\Sigma, n)\)</span> distribution.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>wishart&lt;-<span class="cf">function</span>(sig,d,n){</span>
<span id="cb17-2"><a href="#cb17-2"></a>  T&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>d,<span class="dt">ncol=</span>d)</span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</span>
<span id="cb17-5"><a href="#cb17-5"></a>      <span class="cf">if</span>(i<span class="op">&gt;</span>j) T[i,j]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a>      <span class="cf">else</span> <span class="cf">if</span>(i<span class="op">==</span>j) T[i,j]&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dt">df=</span>n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb17-7"><a href="#cb17-7"></a>    }</span>
<span id="cb17-8"><a href="#cb17-8"></a>  }</span>
<span id="cb17-9"><a href="#cb17-9"></a>  A&lt;-T<span class="op">%*%</span><span class="kw">t</span>(T)  <span class="co">#Wd(Id,n) distribution</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  L&lt;-<span class="kw">t</span>(<span class="kw">chol</span>(sig))  <span class="co">#lower triangular</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>  W&lt;-L<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(L)  <span class="co">#Bartlett’s decomposition</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>  W</span>
<span id="cb17-13"><a href="#cb17-13"></a>}</span></code></pre></div>
<p>So <span class="math inline">\(wishart\)</span> is the function of the random sample from a <span class="math inline">\(W_{d}(\Sigma, n)\)</span> distribution.</p>
</div>
</div>
</div>
<div id="hw-2019-10-11" class="section level1">
<h1>HW-2019-10-11</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.1, 5.10, and 5.15 (pages 149-151, Statistical Computating with R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="exercises-5.1" class="section level3">
<h3>1. Exercises 5.1</h3>
<p>Compute a Monte Carlo estimate of <span class="math inline">\(\int_{0}^{\pi / 3} \sin t d t\)</span> and compare your estimate with the exact value of the integral.</p>
<p><span class="math inline">\(\int_{0}^{\pi / 3} \sin t d t=\frac{\pi}{3} \int_{0}^{\frac{\pi}{3}} \sin t \cdot \frac{3}{\pi} d t=\frac{\pi}{3} E_{X}[\sin X], X \sim U\left[0, \frac{\pi}{3}\right]\)</span>,so <span class="math inline">\(g(x)=\frac{\pi}{3}\sin x\)</span>.</p>
<p>The exact value of the integral is<span class="math inline">\(\int_{0}^{\pi / 3} \sin t d t=1-cos(\pi/3)=0.5\)</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>x&lt;-<span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a>theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="fl">0.5</span>))</span></code></pre></div>
<pre><code>## [1] 0.5012242 0.5000000</code></pre>
<p>The result is very close to the exact value of the integral.</p>
</div>
<div id="exercises-5.10" class="section level3">
<h3>2.Exercises 5.10</h3>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math inline">\(\int_{0}^{1}\frac{e^{-x}}{1+x^{2}} d x\)</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<p><span class="math inline">\(\int_{0}^{1}\frac{e^{-x}}{1+x^{2}} d x=E_{X}[\frac{e^{-x}}{1+x^{2}}],X \sim U\left[0,1\right]\)</span>,<span class="math inline">\(U\)</span> and <span class="math inline">\(1-U\)</span> has the same distribution and negatively correlated.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>MC&lt;-<span class="cf">function</span>(<span class="dt">R=</span><span class="dv">10000</span>,<span class="dt">antithetic=</span><span class="ot">TRUE</span>){</span>
<span id="cb20-2"><a href="#cb20-2"></a>  u&lt;-<span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="cf">if</span>(<span class="op">!</span>antithetic) v&lt;-<span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) </span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="cf">else</span> v&lt;-<span class="dv">1</span><span class="op">-</span>u</span>
<span id="cb20-5"><a href="#cb20-5"></a>  u&lt;-<span class="kw">c</span>(u,v)</span>
<span id="cb20-6"><a href="#cb20-6"></a>  g&lt;-<span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb20-7"><a href="#cb20-7"></a>  g</span>
<span id="cb20-8"><a href="#cb20-8"></a>}</span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a>theta.hat&lt;-<span class="kw">MC</span>(<span class="dt">anti=</span><span class="ot">TRUE</span>)</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#true value of the integral</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>f&lt;-<span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb20-13"><a href="#cb20-13"></a>theta&lt;-<span class="kw">integrate</span>(f,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,theta<span class="op">$</span>value))</span></code></pre></div>
<pre><code>## [1] 0.5246322 0.5247971</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co">#percentage of variance reduction</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>MC1&lt;-MC2&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb22-5"><a href="#cb22-5"></a>  MC1[i]&lt;-<span class="kw">MC</span>(<span class="dt">anti=</span><span class="ot">FALSE</span>)</span>
<span id="cb22-6"><a href="#cb22-6"></a>  MC2[i]&lt;-<span class="kw">MC</span>(<span class="dt">anti=</span><span class="ot">TRUE</span>)</span>
<span id="cb22-7"><a href="#cb22-7"></a>}</span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2),(<span class="kw">sd</span>(MC1)<span class="op">-</span><span class="kw">sd</span>(MC2))<span class="op">/</span><span class="kw">sd</span>(MC1)))</span></code></pre></div>
<pre><code>## [1] 0.0023969362 0.0004560375 0.8097414719</code></pre>
<p>The antithetic variable approach achieved approximately 80.97% reduction in variance.</p>
</div>
<div id="exercises-5.15" class="section level3">
<h3>3.Exercises 5.15</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<p>In Example 5.10,we want to estimate <span class="math inline">\(\int_{0}^{1}\frac{e^{-x}}{1+x^{2}} d x\)</span>.We choose the importance function <span class="math inline">\(f_{3}(x)=e^{-x} /\left(1-e^{-1}\right), 0&lt;x&lt;1\)</span>.Now divide the interval (0,1) into five subintervals,<span class="math inline">\(I_{j}=\left\{x: a_{j-1} \leq x&lt;a_{j}\right\}\)</span>.Then on the <span class="math inline">\(j^{th}\)</span> subinterval variables are generated from the density <span class="math inline">\(\frac{5e^{-x}}{1-e^{-1}},a_{j-1}&lt;x&lt;a_{j}\)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>k&lt;-<span class="dv">5</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>r&lt;-m<span class="op">/</span>k</span>
<span id="cb24-4"><a href="#cb24-4"></a>N&lt;-<span class="dv">1000</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>T2&lt;-<span class="kw">numeric</span>(k)</span>
<span id="cb24-6"><a href="#cb24-6"></a>est&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a>a&lt;-<span class="kw">numeric</span>(k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(k<span class="op">+</span><span class="dv">1</span>)) a[j]&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span>k<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="kw">set.seed</span>(<span class="dv">1235</span>)</span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb24-11"><a href="#cb24-11"></a>  u1&lt;-<span class="kw">runif</span>(m)</span>
<span id="cb24-12"><a href="#cb24-12"></a>  x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb24-13"><a href="#cb24-13"></a>  fg&lt;-(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb24-14"><a href="#cb24-14"></a>  est[i,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(fg)</span>
<span id="cb24-15"><a href="#cb24-15"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb24-16"><a href="#cb24-16"></a>    u2&lt;-<span class="kw">runif</span>(r)</span>
<span id="cb24-17"><a href="#cb24-17"></a>    x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>a[j])<span class="op">-</span>u2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb24-18"><a href="#cb24-18"></a>    fg&lt;-<span class="dv">1</span><span class="op">/</span><span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb24-19"><a href="#cb24-19"></a>    T2[j]&lt;-<span class="kw">mean</span>(fg)<span class="op">*</span><span class="dv">5</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>  }</span>
<span id="cb24-21"><a href="#cb24-21"></a>  est[i,<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(T2)</span>
<span id="cb24-22"><a href="#cb24-22"></a>}</span>
<span id="cb24-23"><a href="#cb24-23"></a>estimate&lt;-<span class="kw">apply</span>(est,<span class="dv">2</span>,mean)</span>
<span id="cb24-24"><a href="#cb24-24"></a>sd&lt;-<span class="kw">apply</span>(est,<span class="dv">2</span>,sd)</span>
<span id="cb24-25"><a href="#cb24-25"></a><span class="kw">print</span>(<span class="kw">rbind</span>(estimate,sd))</span></code></pre></div>
<pre><code>##                 [,1]         [,2]
## estimate 0.524759179 0.5247970375
## sd       0.000961924 0.0001971763</code></pre>
<p>Compared with the result of Example 5.10,it is obvious that the variance is reduced after stratified.</p>
</div>
</div>
</div>
<div id="hw-2019-10-18" class="section level1">
<h1>HW-2019-10-18</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.5 and 6.6 (pages 180, Statistical Computating with R).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="exercises-6.5" class="section level3">
<h3>1. Exercises 6.5</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p><span class="math inline">\(\chi^{2}(2)\)</span> has mean 2.The estimation of the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data is shown as below.If the sample data are normal,the 95% confidence interval is <span class="math inline">\((\bar{X}-\frac{1}{\sqrt{n}}t_{n-1}(0.975)se(X),\bar{X}+\frac{1}{\sqrt{n}}t_{n-1}(0.975)se(X))\)</span>.We still use this confidence interval when the sample data are non-normal.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>CI1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb26-4"><a href="#cb26-4"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb26-6"><a href="#cb26-6"></a>} )</span>
<span id="cb26-7"><a href="#cb26-7"></a>CI2 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb26-8"><a href="#cb26-8"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb26-10"><a href="#cb26-10"></a>} )</span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">#The estimation of the coverage probability</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="kw">mean</span>(CI1<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span>CI2<span class="op">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.908</code></pre>
<p>The simulation results in Example 6.4 when the sample data are non-normal.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb28-4"><a href="#cb28-4"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb28-5"><a href="#cb28-5"></a>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb28-6"><a href="#cb28-6"></a>} )</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.788</code></pre>
<p>Compare the t-interval results with the simulation results in Example 6.4.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(CI1<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span>CI2<span class="op">&gt;</span><span class="dv">2</span>),<span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] 0.908 0.788</code></pre>
<p>We can find that the t-interval is more robust to departures from normality than the interval for variance.</p>
</div>
<div id="exercises-6.6" class="section level3">
<h3>2. Exercises 6.6</h3>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span>.</p>
<p>The skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> is defined as <span class="math inline">\(\sqrt{b_{1}}=\frac{\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{3}}{\left(\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{2}\right)^{3 / 2}}\)</span>.</p>
<p>From (2.14) we know that the variance of the q sample quantile is <span class="math inline">\(\operatorname{Var}\left(\hat{x}_{q}\right)=\frac{q(1-q)}{n f\left(x_{q}\right)^{2}}\)</span>,where f is the density of the sampled distribution.For finite samples,the normal approximation for the density is <span class="math inline">\(N(0,\frac{6(n-2)}{(n+1)(n+3)})\)</span>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>q&lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</span>
<span id="cb32-4"><a href="#cb32-4"></a>skew &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol=</span><span class="dv">4</span>,<span class="dt">nrow=</span>m)</span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb32-6"><a href="#cb32-6"></a>  a&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb32-8"><a href="#cb32-8"></a>    x&lt;-<span class="kw">rnorm</span>(n)</span>
<span id="cb32-9"><a href="#cb32-9"></a>    a[i]&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="kw">var</span>(x))<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a>  }</span>
<span id="cb32-11"><a href="#cb32-11"></a>  skew[j,<span class="dv">1</span>]&lt;-<span class="kw">quantile</span>(a,q[<span class="dv">1</span>])</span>
<span id="cb32-12"><a href="#cb32-12"></a>  skew[j,<span class="dv">2</span>]&lt;-<span class="kw">quantile</span>(a,q[<span class="dv">2</span>])</span>
<span id="cb32-13"><a href="#cb32-13"></a>  skew[j,<span class="dv">3</span>]&lt;-<span class="kw">quantile</span>(a,q[<span class="dv">3</span>])</span>
<span id="cb32-14"><a href="#cb32-14"></a>  skew[j,<span class="dv">4</span>]&lt;-<span class="kw">quantile</span>(a,q[<span class="dv">4</span>])</span>
<span id="cb32-15"><a href="#cb32-15"></a>}</span>
<span id="cb32-16"><a href="#cb32-16"></a><span class="co">#estimated quantiles</span></span>
<span id="cb32-17"><a href="#cb32-17"></a>sq_b1&lt;-<span class="kw">apply</span>(skew,<span class="dv">2</span>,mean)</span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="co">#quantiles of the large sample approximation</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>b&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb32-20"><a href="#cb32-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb32-21"><a href="#cb32-21"></a>  b[i]&lt;-<span class="kw">qnorm</span>(q[i],<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>m))</span>
<span id="cb32-22"><a href="#cb32-22"></a>}</span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="co">#the standard error of the estimates</span></span>
<span id="cb32-24"><a href="#cb32-24"></a>se&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb32-25"><a href="#cb32-25"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb32-26"><a href="#cb32-26"></a>  se[i]&lt;-<span class="kw">sqrt</span>((<span class="dv">1</span><span class="op">/</span>m)<span class="op">*</span>q[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q[i])<span class="op">/</span><span class="kw">dnorm</span>(b[i],<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(m<span class="dv">-2</span>)<span class="op">/</span>((m<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(m<span class="op">+</span><span class="dv">3</span>)))))</span>
<span id="cb32-27"><a href="#cb32-27"></a>}</span>
<span id="cb32-28"><a href="#cb32-28"></a><span class="kw">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.005708130 0.005988196 0.005988196 0.005708130</code></pre>
<p>Compare the estimated quantiles with the quantiles of the large sample approximation.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>a&lt;-<span class="kw">rbind</span>(sq_b1,b)</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="kw">rownames</span>(a)&lt;-<span class="kw">c</span>(<span class="st">&quot;estimated quantiles&quot;</span>,<span class="st">&quot;quantiles of approximation&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">colnames</span>(a)&lt;-q</span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="kw">print</span>(a)</span></code></pre></div>
<pre><code>##                                 0.025       0.05      0.95     0.975
## estimated quantiles        -0.1505601 -0.1261659 0.1264742 0.1506280
## quantiles of approximation -0.1518182 -0.1274098 0.1274098 0.1518182</code></pre>
<p>The result is very close.</p>
</div>
</div>
</div>
<div id="hw-2019-11-01" class="section level1">
<h1>HW-2019-11-01</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.7 and 6.A and discussion (pages 180-181, Statistical Computating with R).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="exercises-6.7" class="section level3">
<h3>1. Exercises 6.7</h3>
<p>Estimate the power of the skewness test of normality against symmetric Beta(α, α) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</p>
<p>First estimate the power of the skewness test of normality against symmetric Beta(α, α) distributions.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">#function to compute the sample skewness statistic</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="co">#computes the sample skewness coeff</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb36-5"><a href="#cb36-5"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb36-7"><a href="#cb36-7"></a>}</span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-9"><a href="#cb36-9"></a>n &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb36-11"><a href="#cb36-11"></a>alpha&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">20</span></span>
<span id="cb36-12"><a href="#cb36-12"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(alpha)</span>
<span id="cb36-13"><a href="#cb36-13"></a>pow &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb36-15"><a href="#cb36-15"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb36-16"><a href="#cb36-16"></a><span class="co">#Power of the skewness test of normality</span></span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb36-18"><a href="#cb36-18"></a>   a &lt;-<span class="st"> </span>alpha[j]</span>
<span id="cb36-19"><a href="#cb36-19"></a>   sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb36-20"><a href="#cb36-20"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb36-21"><a href="#cb36-21"></a>       x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a,a)</span>
<span id="cb36-22"><a href="#cb36-22"></a>       sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb36-23"><a href="#cb36-23"></a>   }</span>
<span id="cb36-24"><a href="#cb36-24"></a>   pow[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb36-25"><a href="#cb36-25"></a>}</span>
<span id="cb36-26"><a href="#cb36-26"></a><span class="co">#plot power vs alpha</span></span>
<span id="cb36-27"><a href="#cb36-27"></a><span class="kw">plot</span>(alpha, pow, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>))</span>
<span id="cb36-28"><a href="#cb36-28"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb36-29"><a href="#cb36-29"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pow <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pow) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb36-30"><a href="#cb36-30"></a><span class="kw">lines</span>(alpha, pow<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb36-31"><a href="#cb36-31"></a><span class="kw">lines</span>(alpha, pow<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot,we can find that the power of the skewness test of normality against symmetric Beta(α, α) distributions is very small,even smaller than 0.05.So we can say that symmetric Beta(α, α) distributions are not in the alternative hypothesis.</p>
<p>Then we estimate the power of the skewness test of normality against heavy-tailed symmetric alternatives such as t(ν).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>n &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>v&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">20</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(v)</span>
<span id="cb37-5"><a href="#cb37-5"></a>pow &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb37-7"><a href="#cb37-7"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="co">#Power of the skewness test of normality</span></span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each v</span></span>
<span id="cb37-10"><a href="#cb37-10"></a>   a &lt;-<span class="st"> </span>v[j]</span>
<span id="cb37-11"><a href="#cb37-11"></a>   sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb37-12"><a href="#cb37-12"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>       x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,a)</span>
<span id="cb37-14"><a href="#cb37-14"></a>       sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb37-15"><a href="#cb37-15"></a>   }</span>
<span id="cb37-16"><a href="#cb37-16"></a>   pow[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb37-17"><a href="#cb37-17"></a>}</span>
<span id="cb37-18"><a href="#cb37-18"></a><span class="co">#plot power vs v</span></span>
<span id="cb37-19"><a href="#cb37-19"></a><span class="kw">plot</span>(v, pow, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(v), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb37-20"><a href="#cb37-20"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb37-21"><a href="#cb37-21"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pow <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pow) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb37-22"><a href="#cb37-22"></a><span class="kw">lines</span>(alpha, pow<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb37-23"><a href="#cb37-23"></a><span class="kw">lines</span>(alpha, pow<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot we can find that the power of the skewness test of normality against t(ν) is much bigger than that of Beta(α, α).So comparing two results,the heavy-tailed symmetric distributions are in the alternative hypothesis,the Beta(α, α) is not suitable to this test.</p>
</div>
<div id="exercises-6.a" class="section level3">
<h3>2. Exercises 6.A</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^{2}(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_{0}:\mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{0}: \mu \neq \mu_{0}\)</span>, where <span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
<ul>
<li><span class="math inline">\(\chi^{2}(1)\)</span></li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">100</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>N&lt;-<span class="kw">length</span>(n)</span>
<span id="cb38-3"><a href="#cb38-3"></a>t1&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb38-4"><a href="#cb38-4"></a>se.hat&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb38-5"><a href="#cb38-5"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>mu0 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb38-9"><a href="#cb38-9"></a>  l&lt;-n[i]</span>
<span id="cb38-10"><a href="#cb38-10"></a>  p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb38-11"><a href="#cb38-11"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb38-12"><a href="#cb38-12"></a>        x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(l, <span class="dv">1</span>)</span>
<span id="cb38-13"><a href="#cb38-13"></a>        ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,  <span class="dt">mu =</span> mu0)</span>
<span id="cb38-14"><a href="#cb38-14"></a>        p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb38-15"><a href="#cb38-15"></a>   }</span>
<span id="cb38-16"><a href="#cb38-16"></a>  t1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb38-17"><a href="#cb38-17"></a>  se.hat[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(t1[i] <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>t1[i]) <span class="op">/</span><span class="st"> </span>m)</span>
<span id="cb38-18"><a href="#cb38-18"></a>}</span>
<span id="cb38-19"><a href="#cb38-19"></a>X&lt;-<span class="kw">rbind</span>(t1,se.hat)</span>
<span id="cb38-20"><a href="#cb38-20"></a><span class="kw">colnames</span>(X)&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">100</span>)</span>
<span id="cb38-21"><a href="#cb38-21"></a><span class="kw">print</span>(X)</span></code></pre></div>
<pre><code>##                 10          20          40          50          80         100
## t1     0.141700000 0.108400000 0.081400000 0.075500000 0.070300000 0.062000000
## se.hat 0.003487422 0.003108849 0.002734484 0.002641964 0.002556519 0.002411556</code></pre>
<p>The empirical Type I error rate of the <span class="math inline">\(\chi^{2}(1)\)</span> is smaller than the nominal significance level α=0.05.</p>
<ul>
<li>Uniform(0,2)</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">100</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a>N&lt;-<span class="kw">length</span>(n)</span>
<span id="cb40-3"><a href="#cb40-3"></a>t1&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb40-4"><a href="#cb40-4"></a>se.hat&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb40-5"><a href="#cb40-5"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>mu0 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb40-8"><a href="#cb40-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb40-9"><a href="#cb40-9"></a>  l&lt;-n[i]</span>
<span id="cb40-10"><a href="#cb40-10"></a>  p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb40-11"><a href="#cb40-11"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb40-12"><a href="#cb40-12"></a>        x &lt;-<span class="st"> </span><span class="kw">runif</span>(l,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb40-13"><a href="#cb40-13"></a>        ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,  <span class="dt">mu =</span> mu0)</span>
<span id="cb40-14"><a href="#cb40-14"></a>        p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb40-15"><a href="#cb40-15"></a>   }</span>
<span id="cb40-16"><a href="#cb40-16"></a>  t1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb40-17"><a href="#cb40-17"></a>  se.hat[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(t1[i] <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>t1[i]) <span class="op">/</span><span class="st"> </span>m)</span>
<span id="cb40-18"><a href="#cb40-18"></a>}</span>
<span id="cb40-19"><a href="#cb40-19"></a>X&lt;-<span class="kw">rbind</span>(t1,se.hat)</span>
<span id="cb40-20"><a href="#cb40-20"></a><span class="kw">colnames</span>(X)&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">100</span>)</span>
<span id="cb40-21"><a href="#cb40-21"></a><span class="kw">print</span>(X)</span></code></pre></div>
<pre><code>##                 10          20          40          50          80         100
## t1     0.051900000 0.050100000 0.049700000 0.048700000 0.050200000 0.050600000
## se.hat 0.002218251 0.002181513 0.002173244 0.002152401 0.002183574 0.002191795</code></pre>
<p>From the result,we can see that the empirical Type I error rate of the Uniform(0,2) is close to the nominal significance level α=0.05.</p>
<ul>
<li>Exponential(1)</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">100</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>N&lt;-<span class="kw">length</span>(n)</span>
<span id="cb42-3"><a href="#cb42-3"></a>t1&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb42-4"><a href="#cb42-4"></a>se.hat&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb42-5"><a href="#cb42-5"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>mu0 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb42-9"><a href="#cb42-9"></a>  l&lt;-n[i]</span>
<span id="cb42-10"><a href="#cb42-10"></a>  p&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb42-11"><a href="#cb42-11"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb42-12"><a href="#cb42-12"></a>        x &lt;-<span class="st"> </span><span class="kw">rexp</span>(l,<span class="dv">1</span>)</span>
<span id="cb42-13"><a href="#cb42-13"></a>        ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0)</span>
<span id="cb42-14"><a href="#cb42-14"></a>        p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb42-15"><a href="#cb42-15"></a>   }</span>
<span id="cb42-16"><a href="#cb42-16"></a>  t1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb42-17"><a href="#cb42-17"></a>  se.hat[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(t1[i] <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>t1[i]) <span class="op">/</span><span class="st"> </span>m)</span>
<span id="cb42-18"><a href="#cb42-18"></a>}</span>
<span id="cb42-19"><a href="#cb42-19"></a>X&lt;-<span class="kw">rbind</span>(t1,se.hat)</span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="kw">colnames</span>(X)&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">100</span>)</span>
<span id="cb42-21"><a href="#cb42-21"></a><span class="kw">print</span>(X)</span></code></pre></div>
<pre><code>##                 10         20          40          50          80         100
## t1     0.101200000 0.08210000 0.067600000 0.062100000 0.062000000 0.058700000
## se.hat 0.003015934 0.00274517 0.002510582 0.002413371 0.002411556 0.002350624</code></pre>
<p>From the result,we can see that the empirical Type I error rate of the Exponential(1) is smaller than the nominal significance level α=0.05.</p>
</div>
<div id="discussion" class="section level3">
<h3>3.Discussion</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10000 experiments:say,0.651 for one method and 0.676 for another method.Can we say the powes are different at 0.05 level?</p>
<ul>
<li>What is the corresponding hypothesis test problem?</li>
</ul>
<p><span class="math inline">\(H_{0}:pw_{1}=pw_{2}\)</span>,<span class="math inline">\(pw_{1},pw_{2}\)</span> represents the powers for two methods under a particular simulation.</p>
<ul>
<li>What test should we use?</li>
</ul>
<p>We should use McNemar test.It’s about two test on the same sample.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>X&lt;-<span class="kw">c</span>(<span class="dv">6510</span>,<span class="dv">3490</span>,<span class="dv">3240</span>,<span class="dv">6760</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="kw">dim</span>(X)&lt;-<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="kw">mcnemar.test</span>(X,<span class="dt">correct=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  McNemar&#39;s Chi-squared test
## 
## data:  X
## McNemar&#39;s chi-squared = 9.2868, df = 1, p-value = 0.002308</code></pre>
<p>p-value&lt;0.05,so we think that the powers are different.</p>
<ul>
<li>What information is needed to test your hypothesis?</li>
</ul>
<p>The samples should be the same,the method is applied to the same population.</p>
</div>
</div>
</div>
<div id="hw-2019-11-08" class="section level1">
<h1>HW-2019-11-08</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercise 7.6 and Project 7.B (pages 212-213, Statistical Computating with R).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="exercises-7.6" class="section level3">
<h3>1. Exercises 7.6</h3>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\((x_{i1},...,x_{i5})\)</span> for the <span class="math inline">\(i^{th}\)</span> student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates:<span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec}),\hat{\rho}_{34}=\hat{\rho}(\mathrm{alg}, \mathrm{ana}),\hat{\rho}_{35}=\hat{\rho}(\mathrm{alg}, \mathrm{sta}),\hat{\rho}_{45}=\hat{\rho}(\mathrm{ana}, \mathrm{sta})\)</span>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw">head</span>(scor)</span></code></pre></div>
<pre><code>##   mec vec alg ana sta
## 1  77  82  67  67  81
## 2  63  78  80  70  81
## 3  75  73  71  66  81
## 4  55  72  63  70  68
## 5  63  63  65  70  63
## 6  53  61  72  64  73</code></pre>
<p>We can see that the data “scor” is the test score of five subjects on 88 students.</p>
<p>First display the scatter plots for each pair of test scores.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">pairs</span>(scor)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">cor</span>(scor)</span></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<p>Comparing the plot with the sample correlation matrix,they show similar correlation between the five test scores.The correlations between mec and vec,mec and alg,vec and alg,alg and ana,alg and sta are significant.</p>
<p>Then obtain bootstrap estimates of the standard errors for <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec}),\hat{\rho}_{34}=\hat{\rho}(\mathrm{alg}, \mathrm{ana}),\hat{\rho}_{35}=\hat{\rho}(\mathrm{alg}, \mathrm{sta}),\hat{\rho}_{45}=\hat{\rho}(\mathrm{ana}, \mathrm{sta})\)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co">#correlation functions</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>r12&lt;-<span class="cf">function</span>(x,i){</span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])</span>
<span id="cb51-4"><a href="#cb51-4"></a>}</span>
<span id="cb51-5"><a href="#cb51-5"></a>r34&lt;-<span class="cf">function</span>(x,i){</span>
<span id="cb51-6"><a href="#cb51-6"></a>  <span class="kw">cor</span>(x[i,<span class="dv">3</span>],x[i,<span class="dv">4</span>])</span>
<span id="cb51-7"><a href="#cb51-7"></a>}</span>
<span id="cb51-8"><a href="#cb51-8"></a>r35&lt;-<span class="cf">function</span>(x,i){</span>
<span id="cb51-9"><a href="#cb51-9"></a>  <span class="kw">cor</span>(x[i,<span class="dv">3</span>],x[i,<span class="dv">5</span>])</span>
<span id="cb51-10"><a href="#cb51-10"></a>}</span>
<span id="cb51-11"><a href="#cb51-11"></a>r45&lt;-<span class="cf">function</span>(x,i){</span>
<span id="cb51-12"><a href="#cb51-12"></a>  <span class="kw">cor</span>(x[i,<span class="dv">4</span>],x[i,<span class="dv">5</span>])</span>
<span id="cb51-13"><a href="#cb51-13"></a>}</span>
<span id="cb51-14"><a href="#cb51-14"></a><span class="co">#bootstrap estimates</span></span>
<span id="cb51-15"><a href="#cb51-15"></a><span class="kw">library</span>(boot)</span>
<span id="cb51-16"><a href="#cb51-16"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb51-17"><a href="#cb51-17"></a>obj12&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>r12,<span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb51-18"><a href="#cb51-18"></a>obj34&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>r34,<span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb51-19"><a href="#cb51-19"></a>obj35&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>r35,<span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb51-20"><a href="#cb51-20"></a>obj45&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>r45,<span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb51-21"><a href="#cb51-21"></a>r&lt;-<span class="kw">c</span>(obj12<span class="op">$</span>t0,obj34<span class="op">$</span>t0,obj35<span class="op">$</span>t0,obj45<span class="op">$</span>t0)</span>
<span id="cb51-22"><a href="#cb51-22"></a>b&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(obj12<span class="op">$</span>t)<span class="op">-</span>obj12<span class="op">$</span>t0,<span class="kw">mean</span>(obj34<span class="op">$</span>t)<span class="op">-</span>obj34<span class="op">$</span>t0,<span class="kw">mean</span>(obj35<span class="op">$</span>t)<span class="op">-</span>obj35<span class="op">$</span>t0,<span class="kw">mean</span>(obj45<span class="op">$</span>t)<span class="op">-</span>obj45<span class="op">$</span>t0)</span>
<span id="cb51-23"><a href="#cb51-23"></a>se&lt;-<span class="kw">c</span>(<span class="kw">sd</span>(obj12<span class="op">$</span>t),<span class="kw">sd</span>(obj34<span class="op">$</span>t),<span class="kw">sd</span>(obj35<span class="op">$</span>t),<span class="kw">sd</span>(obj45<span class="op">$</span>t))</span>
<span id="cb51-24"><a href="#cb51-24"></a>X&lt;-<span class="kw">cbind</span>(r,b,se)</span>
<span id="cb51-25"><a href="#cb51-25"></a><span class="kw">colnames</span>(X)&lt;-<span class="kw">c</span>(<span class="st">&quot;correlation&quot;</span>,<span class="st">&quot;bias&quot;</span>,<span class="st">&quot;se&quot;</span>)</span>
<span id="cb51-26"><a href="#cb51-26"></a><span class="kw">rownames</span>(X)&lt;-<span class="kw">c</span>(<span class="st">&quot;ρ12&quot;</span>,<span class="st">&quot;ρ34&quot;</span>,<span class="st">&quot;ρ35&quot;</span>,<span class="st">&quot;ρ45&quot;</span>)</span>
<span id="cb51-27"><a href="#cb51-27"></a><span class="kw">round</span>(X,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##     correlation     bias      se
## ρ12     0.55341 -0.00582 0.07733
## ρ34     0.71081 -0.00230 0.04684
## ρ35     0.66474 -0.00166 0.05961
## ρ45     0.60717 -0.00298 0.06638</code></pre>
</div>
<div id="project-7.b" class="section level3">
<h3>2.Project 7.B</h3>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions (positive skewness).</p>
<p>First get the three different confidence intervals of two distributions.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="co">#sample data matrix of normal distributions and χ2(5) distributions</span></span>
<span id="cb53-5"><a href="#cb53-5"></a>skewness&lt;-<span class="cf">function</span>(X,i){</span>
<span id="cb53-6"><a href="#cb53-6"></a>  x&lt;-X[i]</span>
<span id="cb53-7"><a href="#cb53-7"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb53-8"><a href="#cb53-8"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb53-9"><a href="#cb53-9"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb53-10"><a href="#cb53-10"></a>}</span>
<span id="cb53-11"><a href="#cb53-11"></a>ci.norm1&lt;-ci.basic1&lt;-ci.perc1&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</span>
<span id="cb53-12"><a href="#cb53-12"></a>ci.norm2&lt;-ci.basic2&lt;-ci.perc2&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</span>
<span id="cb53-13"><a href="#cb53-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb53-14"><a href="#cb53-14"></a>  X1&lt;-<span class="kw">rnorm</span>(n)</span>
<span id="cb53-15"><a href="#cb53-15"></a>  boot1&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>X1,<span class="dt">statistic =</span> skewness,<span class="dt">R=</span><span class="dv">1000</span>)</span>
<span id="cb53-16"><a href="#cb53-16"></a>  ci1&lt;-<span class="kw">boot.ci</span>(boot1,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb53-17"><a href="#cb53-17"></a>  ci.norm1[i,]&lt;-ci1<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb53-18"><a href="#cb53-18"></a>  ci.basic1[i,]&lt;-ci1<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb53-19"><a href="#cb53-19"></a>  ci.perc1[i,]&lt;-ci1<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb53-20"><a href="#cb53-20"></a>}</span>
<span id="cb53-21"><a href="#cb53-21"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb53-22"><a href="#cb53-22"></a>  X2&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb53-23"><a href="#cb53-23"></a>  boot2&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>X2,<span class="dt">statistic =</span> skewness,<span class="dt">R=</span><span class="dv">1000</span>)</span>
<span id="cb53-24"><a href="#cb53-24"></a>  ci2&lt;-<span class="kw">boot.ci</span>(boot2,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb53-25"><a href="#cb53-25"></a>  ci.norm2[i,]&lt;-ci2<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb53-26"><a href="#cb53-26"></a>  ci.basic2[i,]&lt;-ci2<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb53-27"><a href="#cb53-27"></a>  ci.perc2[i,]&lt;-ci2<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb53-28"><a href="#cb53-28"></a>}</span></code></pre></div>
<p>Then compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions.The skewness of <span class="math inline">\(\chi^{2}(5)\)</span> is <span class="math inline">\(\sqrt{\beta_{1}}=\frac{E\left[\left(X-\mu_{X}\right)\right]^{3}}{\sigma_{X}^{3}}=\frac{E\left[\left(X-5\right)\right]^{3}}{10^{3/2}}=\frac{40}{10^{3/2}}=\sqrt{8/5}\)</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>mu1&lt;-<span class="dv">0</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>mu2&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb54-3"><a href="#cb54-3"></a>c1&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm1[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.norm1[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),<span class="kw">mean</span>(ci.basic1[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.basic1[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),<span class="kw">mean</span>(ci.perc1[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.perc1[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1))</span>
<span id="cb54-4"><a href="#cb54-4"></a>c2&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm2[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu2<span class="op">&amp;</span>ci.norm2[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu2),<span class="kw">mean</span>(ci.basic2[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu2<span class="op">&amp;</span>ci.basic2[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu2),<span class="kw">mean</span>(ci.perc2[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu2<span class="op">&amp;</span>ci.perc2[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu2))</span>
<span id="cb54-5"><a href="#cb54-5"></a>X&lt;-<span class="kw">rbind</span>(c1,c2)</span>
<span id="cb54-6"><a href="#cb54-6"></a><span class="kw">colnames</span>(X)&lt;-<span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="kw">rownames</span>(X)&lt;-<span class="kw">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;χ2(5)&quot;</span>)</span>
<span id="cb54-8"><a href="#cb54-8"></a><span class="kw">print</span>(X)</span></code></pre></div>
<pre><code>##          norm  basic   perc
## normal 0.9149 0.9108 0.9399
## χ2(5)  0.7794 0.7517 0.7592</code></pre>
<p>From the results,we can find that the coverage rates for normal populations is close to 95%.The coverage rates for χ2(5) distributions is smaller than 95%.</p>
<p>Find the proportion of times that the confidence intervals miss on the left, and the porportion of times that the confidence intervals miss on the right.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>l1&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm1[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1),<span class="kw">mean</span>(ci.basic1[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1),<span class="kw">mean</span>(ci.perc1[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1))</span>
<span id="cb56-2"><a href="#cb56-2"></a>l2&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm2[,<span class="dv">1</span>]<span class="op">&gt;</span>mu2),<span class="kw">mean</span>(ci.basic2[,<span class="dv">1</span>]<span class="op">&gt;</span>mu2),<span class="kw">mean</span>(ci.perc2[,<span class="dv">1</span>]<span class="op">&gt;</span>mu2))</span>
<span id="cb56-3"><a href="#cb56-3"></a>r1&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm1[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1),<span class="kw">mean</span>(ci.basic1[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1),<span class="kw">mean</span>(ci.perc1[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1))</span>
<span id="cb56-4"><a href="#cb56-4"></a>r2&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm2[,<span class="dv">2</span>]<span class="op">&lt;</span>mu2),<span class="kw">mean</span>(ci.basic2[,<span class="dv">2</span>]<span class="op">&lt;</span>mu2),<span class="kw">mean</span>(ci.perc2[,<span class="dv">2</span>]<span class="op">&lt;</span>mu2))</span>
<span id="cb56-5"><a href="#cb56-5"></a>X1&lt;-<span class="kw">rbind</span>(l1,r1,l2,r2)</span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="kw">colnames</span>(X1)&lt;-<span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="kw">rownames</span>(X1)&lt;-<span class="kw">c</span>(<span class="st">&quot;left miss(normal)&quot;</span>,<span class="st">&quot;right miss(normal)&quot;</span>,<span class="st">&quot;left miss(χ2(5))&quot;</span>,<span class="st">&quot;right miss(χ2(5))&quot;</span>)</span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="kw">print</span>(X1)</span></code></pre></div>
<pre><code>##                      norm  basic   perc
## left miss(normal)  0.0413 0.0430 0.0304
## right miss(normal) 0.0438 0.0462 0.0297
## left miss(χ2(5))   0.0232 0.0467 0.0016
## right miss(χ2(5))  0.1974 0.2016 0.2392</code></pre>
<p>For normal distribution, the missing proportions of left and right are balanced because of the symmetry of normal.And for χ2(5) distributions the missing proportions of left and right are different,the porportion of times that the confidence intervals miss on the right is bigger than the left due to the asymmetry of χ2(5) distributions.</p>
</div>
</div>
</div>
<div id="hw-2019-11-15" class="section level1">
<h1>HW-2019-11-15</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercise 7.8 and 7.10 (pages 213, Statistical Computating with R).</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="exercises-7.8" class="section level3">
<h3>1. Exercises 7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects(mechanics, vectors,algebra, analysis, statistics). The five-dimensional scores data have a 5 × 5 covariance matrix <span class="math inline">\(\Sigma\)</span>,with positive eigenvalues<span class="math inline">\(\lambda_{1}&gt;\cdots&gt;\lambda_{5}\)</span>.In principal components analysis,<span class="math inline">\(\theta=\frac{\lambda_{1}}{\sum_{j=1}^{5} \lambda_{j}}\)</span> measures the proportion of variance explained by the first principal component.Let <span class="math inline">\(\hat{\lambda}_{1}&gt;\cdots&gt;\hat{\lambda}_{5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>.Compute the sample estimate <span class="math inline">\(\hat{\theta}=\frac{\hat{\lambda}_{1}}{\sum_{j=1}^{5} \hat{\lambda}_{j}}\)</span>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="co">#proportion function</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>x&lt;-<span class="kw">as.matrix</span>(scor)</span>
<span id="cb58-4"><a href="#cb58-4"></a>theta&lt;-<span class="cf">function</span>(x,n){</span>
<span id="cb58-5"><a href="#cb58-5"></a>  sigma&lt;-(n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">cov</span>(x)</span>
<span id="cb58-6"><a href="#cb58-6"></a>  lamda&lt;-<span class="kw">eigen</span>(sigma)<span class="op">$</span>values</span>
<span id="cb58-7"><a href="#cb58-7"></a>  theta&lt;-lamda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lamda)</span>
<span id="cb58-8"><a href="#cb58-8"></a>  theta</span>
<span id="cb58-9"><a href="#cb58-9"></a>}</span>
<span id="cb58-10"><a href="#cb58-10"></a>n&lt;-<span class="kw">nrow</span>(x)</span>
<span id="cb58-11"><a href="#cb58-11"></a>theta.hat&lt;-<span class="kw">theta</span>(x,n)</span>
<span id="cb58-12"><a href="#cb58-12"></a>theta.jack&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb58-13"><a href="#cb58-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) theta.jack[i]&lt;-<span class="kw">theta</span>(x[<span class="op">-</span>i,],n<span class="dv">-1</span>)</span>
<span id="cb58-14"><a href="#cb58-14"></a>bias.jack&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb58-15"><a href="#cb58-15"></a>se.jack&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb58-16"><a href="#cb58-16"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias.jack=</span>bias.jack,<span class="dt">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="exercise-7.10" class="section level3">
<h3>2.Exercise 7.10</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
<p>The proposed models for predicting magnetic measurement (Y) from chemical measurement (X) are:</p>
<p>1.Linear:<span class="math inline">\(Y=\beta_{0}+\beta_{1} X+\varepsilon\)</span></p>
<p>2.Quadratic:<span class="math inline">\(Y=\beta_{0}+\beta_{1} X+\beta_{2} X^{2}+\varepsilon\)</span></p>
<p>3.Exponential:<span class="math inline">\(\log (Y)=\log \left(\beta_{0}\right)+\beta_{1} X+\varepsilon\)</span></p>
<p>4.Cubic Polynomial:<span class="math inline">\(Y=\beta_{0}+\beta_{1} X+\beta_{2} X^{2}+\beta_{2} X^{3}+\varepsilon\)</span></p>
<p>First construct plots of the predicted response with the data for each model.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</span></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></span>
<span id="cb64-2"><a href="#cb64-2"></a></span>
<span id="cb64-3"><a href="#cb64-3"></a>L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb64-5"><a href="#cb64-5"></a>yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb65-3"><a href="#cb65-3"></a>yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a>logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</span>
<span id="cb66-4"><a href="#cb66-4"></a>yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb66-5"><a href="#cb66-5"></a><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Cubic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb67-3"><a href="#cb67-3"></a>yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="kw">lines</span>(a, yhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then we use cross validation procedure to estimate prediction error.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb68-3"><a href="#cb68-3"></a></span>
<span id="cb68-4"><a href="#cb68-4"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb68-5"><a href="#cb68-5"></a>   y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</span>
<span id="cb68-6"><a href="#cb68-6"></a>   x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</span>
<span id="cb68-7"><a href="#cb68-7"></a>   </span>
<span id="cb68-8"><a href="#cb68-8"></a>   L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb68-9"><a href="#cb68-9"></a>   yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb68-10"><a href="#cb68-10"></a>   e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb68-11"><a href="#cb68-11"></a>   </span>
<span id="cb68-12"><a href="#cb68-12"></a>   L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb68-13"><a href="#cb68-13"></a>   yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb68-14"><a href="#cb68-14"></a>   e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb68-15"><a href="#cb68-15"></a>   </span>
<span id="cb68-16"><a href="#cb68-16"></a>   L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb68-17"><a href="#cb68-17"></a>   logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb68-18"><a href="#cb68-18"></a>   yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb68-19"><a href="#cb68-19"></a>   e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb68-20"><a href="#cb68-20"></a>   </span>
<span id="cb68-21"><a href="#cb68-21"></a>   L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb68-22"><a href="#cb68-22"></a>   yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></span>
<span id="cb68-23"><a href="#cb68-23"></a>   e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb68-24"><a href="#cb68-24"></a>}</span>
<span id="cb68-25"><a href="#cb68-25"></a>X&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)),<span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb68-26"><a href="#cb68-26"></a><span class="kw">rownames</span>(X)&lt;-<span class="st">&quot;prediction error&quot;</span></span>
<span id="cb68-27"><a href="#cb68-27"></a><span class="kw">colnames</span>(X)&lt;-<span class="kw">c</span>(<span class="st">&quot;Linear&quot;</span>,<span class="st">&quot;Quadratic&quot;</span>,<span class="st">&quot;Exponential&quot;</span>,<span class="st">&quot;Cubic&quot;</span>)</span>
<span id="cb68-28"><a href="#cb68-28"></a><span class="kw">round</span>(X,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                  Linear Quadratic Exponential  Cubic
## prediction error 19.556    17.852      18.442 18.178</code></pre>
<p>According to the prediction error estimated by cross validation procedure, Model 2, the quadratic model,would be the best fit for the data.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>L2&lt;-<span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb70-2"><a href="#cb70-2"></a>L2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>Then we compare the adjusted <span class="math inline">\(R^2\)</span> of four models.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</span>
<span id="cb72-2"><a href="#cb72-2"></a>L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb72-3"><a href="#cb72-3"></a>L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</span>
<span id="cb72-4"><a href="#cb72-4"></a>L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb72-5"><a href="#cb72-5"></a>r1&lt;-<span class="kw">summary</span>(L1)</span>
<span id="cb72-6"><a href="#cb72-6"></a>r2&lt;-<span class="kw">summary</span>(L2)</span>
<span id="cb72-7"><a href="#cb72-7"></a>r3&lt;-<span class="kw">summary</span>(L3)</span>
<span id="cb72-8"><a href="#cb72-8"></a>r4&lt;-<span class="kw">summary</span>(L4)</span>
<span id="cb72-9"><a href="#cb72-9"></a>X&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(r1<span class="op">$</span>adj.r.squared, r2<span class="op">$</span>adj.r.squared, r3<span class="op">$</span>adj.r.squared, r4<span class="op">$</span>adj.r.squared),<span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb72-10"><a href="#cb72-10"></a><span class="kw">rownames</span>(X)&lt;-<span class="st">&quot;adjusted R square&quot;</span></span>
<span id="cb72-11"><a href="#cb72-11"></a><span class="kw">colnames</span>(X)&lt;-<span class="kw">c</span>(<span class="st">&quot;Linear&quot;</span>,<span class="st">&quot;Quadratic&quot;</span>,<span class="st">&quot;Exponential&quot;</span>,<span class="st">&quot;Cubic&quot;</span>)</span>
<span id="cb72-12"><a href="#cb72-12"></a><span class="kw">round</span>(X,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                   Linear Quadratic Exponential Cubic
## adjusted R square  0.528     0.577       0.528 0.574</code></pre>
<p>According to the adjusted <span class="math inline">\(R^2\)</span> of four models, Model 2, the quadratic model,would be the best fit for the data.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>L2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
</div>
</div>
</div>
<div id="hw-2019-11-22" class="section level1">
<h1>HW-2019-11-22</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Exercise 8.3(pages 243, Statistical Computating with R) and slides page 31.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="exercises-8.3" class="section level3">
<h3>1. Exercises 8.3</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<p>First implement a permutation test for equal variance based on the maximum number of extreme points.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>count5test&lt;-<span class="cf">function</span>(x,y){</span>
<span id="cb76-2"><a href="#cb76-2"></a>   x&lt;-x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb76-3"><a href="#cb76-3"></a>   y&lt;-y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb76-4"><a href="#cb76-4"></a>   outx&lt;-<span class="kw">sum</span>(x<span class="op">&gt;</span><span class="kw">max</span>(y))<span class="op">+</span><span class="kw">sum</span>(x<span class="op">&lt;</span><span class="kw">min</span>(y))</span>
<span id="cb76-5"><a href="#cb76-5"></a>   outy&lt;-<span class="kw">sum</span>(y<span class="op">&gt;</span><span class="kw">max</span>(x))<span class="op">+</span><span class="kw">sum</span>(y<span class="op">&lt;</span><span class="kw">min</span>(y))</span>
<span id="cb76-6"><a href="#cb76-6"></a>   <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx,outy))<span class="op">&gt;</span><span class="dv">5</span>))</span>
<span id="cb76-7"><a href="#cb76-7"></a>}</span>
<span id="cb76-8"><a href="#cb76-8"></a>permutation_test&lt;-<span class="cf">function</span>(R,n){</span>
<span id="cb76-9"><a href="#cb76-9"></a>   x&lt;-<span class="kw">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb76-10"><a href="#cb76-10"></a>   y&lt;-<span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb76-11"><a href="#cb76-11"></a>   z&lt;-<span class="kw">c</span>(x,y)</span>
<span id="cb76-12"><a href="#cb76-12"></a>   reps&lt;-<span class="kw">numeric</span>(R)</span>
<span id="cb76-13"><a href="#cb76-13"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb76-14"><a href="#cb76-14"></a>      k&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,<span class="dt">size=</span>n1,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb76-15"><a href="#cb76-15"></a>      x1&lt;-z[k]</span>
<span id="cb76-16"><a href="#cb76-16"></a>      reps[i]&lt;-<span class="kw">count5test</span>(x1,x)</span>
<span id="cb76-17"><a href="#cb76-17"></a>   }</span>
<span id="cb76-18"><a href="#cb76-18"></a>   <span class="kw">mean</span>(reps)</span>
<span id="cb76-19"><a href="#cb76-19"></a>}</span></code></pre></div>
<p>Check the test when sample sizes are equal.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co">#when sample sizes are equal</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>n1&lt;-n2&lt;-<span class="dv">20</span></span>
<span id="cb77-3"><a href="#cb77-3"></a>mu1&lt;-mu2&lt;-<span class="dv">0</span></span>
<span id="cb77-4"><a href="#cb77-4"></a>sigma1&lt;-sigma2&lt;-<span class="dv">1</span></span>
<span id="cb77-5"><a href="#cb77-5"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb77-6"><a href="#cb77-6"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb77-7"><a href="#cb77-7"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb77-8"><a href="#cb77-8"></a>alphahat1&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="kw">permutation_test</span>(R,n1<span class="op">+</span>n2)))</span>
<span id="cb77-9"><a href="#cb77-9"></a><span class="kw">round</span>(alphahat1,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.0055</code></pre>
<p>When sample sizes are equal,the empirical Type I error rate was 0.0055.It is controlled well.</p>
<p>Then estimate the empirical Type I error rate when sample sizes are unequal.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co">#when sample sizes are unequal</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb79-3"><a href="#cb79-3"></a>n2&lt;-<span class="dv">30</span></span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb79-5"><a href="#cb79-5"></a>alphahat2&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="kw">permutation_test</span>(R,n1<span class="op">+</span>n2)))</span>
<span id="cb79-6"><a href="#cb79-6"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb79-7"><a href="#cb79-7"></a>n2&lt;-<span class="dv">35</span></span>
<span id="cb79-8"><a href="#cb79-8"></a><span class="kw">set.seed</span>(<span class="dv">1233</span>)</span>
<span id="cb79-9"><a href="#cb79-9"></a>alphahat3&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="kw">permutation_test</span>(R,n1<span class="op">+</span>n2)))</span>
<span id="cb79-10"><a href="#cb79-10"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb79-11"><a href="#cb79-11"></a>n2&lt;-<span class="dv">40</span></span>
<span id="cb79-12"><a href="#cb79-12"></a><span class="kw">set.seed</span>(<span class="dv">1232</span>)</span>
<span id="cb79-13"><a href="#cb79-13"></a>alphahat4&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="kw">permutation_test</span>(R,n1<span class="op">+</span>n2)))</span>
<span id="cb79-14"><a href="#cb79-14"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb79-15"><a href="#cb79-15"></a>n2&lt;-<span class="dv">50</span></span>
<span id="cb79-16"><a href="#cb79-16"></a><span class="kw">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb79-17"><a href="#cb79-17"></a>alphahat5&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="kw">permutation_test</span>(R,n1<span class="op">+</span>n2)))</span>
<span id="cb79-18"><a href="#cb79-18"></a>a&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(alphahat2,alphahat3,alphahat4,alphahat5),<span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb79-19"><a href="#cb79-19"></a><span class="kw">colnames</span>(a)&lt;-<span class="kw">c</span>(<span class="st">&quot;n1=20,n2=30&quot;</span>,<span class="st">&quot;n1=20,n2=35&quot;</span>,<span class="st">&quot;n1=20,n2=40&quot;</span>,<span class="st">&quot;n1=20,n2=50&quot;</span>)</span>
<span id="cb79-20"><a href="#cb79-20"></a><span class="kw">rownames</span>(a)&lt;-<span class="st">&quot;type I error&quot;</span></span>
<span id="cb79-21"><a href="#cb79-21"></a><span class="kw">round</span>(a,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##              n1=20,n2=30 n1=20,n2=35 n1=20,n2=40 n1=20,n2=50
## type I error      0.0093      0.0094       0.012      0.0149</code></pre>
<p>We can see that the empirical Type I error rate was controlled less than 0.05.</p>
</div>
<div id="slides-page-31" class="section level3">
<h3>2.slides page 31</h3>
<p>Power comparison(distance correlation test versus ball covariance test).</p>
<p>Model 1:<span class="math inline">\(Y=X/4+e\)</span></p>
<p>Model 2:<span class="math inline">\(Y=X/4×e\)</span></p>
<p><span class="math inline">\(X\sim N(0_{2},I_{2}),e\sim N(0_{2},I_{2})\)</span>,X and e are independent.</p>
<p>Basic idea:</p>
<p>First write the function of distance correlation test.</p>
<p>Then for each model,calculate powers of two methods.</p>
<p>Finally show the power comparison by plots.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb81-4"><a href="#cb81-4"></a><span class="co">#function of distance correlation test</span></span>
<span id="cb81-5"><a href="#cb81-5"></a>dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb81-6"><a href="#cb81-6"></a>   x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</span>
<span id="cb81-7"><a href="#cb81-7"></a>   y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</span>
<span id="cb81-8"><a href="#cb81-8"></a>   n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb81-9"><a href="#cb81-9"></a>   m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</span>
<span id="cb81-10"><a href="#cb81-10"></a>   <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</span>
<span id="cb81-11"><a href="#cb81-11"></a>   <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y))))) <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</span>
<span id="cb81-12"><a href="#cb81-12"></a>   Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb81-13"><a href="#cb81-13"></a>     d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</span>
<span id="cb81-14"><a href="#cb81-14"></a>     m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d)</span>
<span id="cb81-15"><a href="#cb81-15"></a>     M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</span>
<span id="cb81-16"><a href="#cb81-16"></a>     a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m)</span>
<span id="cb81-17"><a href="#cb81-17"></a>     b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</span>
<span id="cb81-18"><a href="#cb81-18"></a>     <span class="kw">return</span>(b <span class="op">+</span><span class="st"> </span>M)</span>
<span id="cb81-19"><a href="#cb81-19"></a>   }</span>
<span id="cb81-20"><a href="#cb81-20"></a>   A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x)</span>
<span id="cb81-21"><a href="#cb81-21"></a>   B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</span>
<span id="cb81-22"><a href="#cb81-22"></a>   dCov &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</span>
<span id="cb81-23"><a href="#cb81-23"></a>   dCov</span>
<span id="cb81-24"><a href="#cb81-24"></a>}</span>
<span id="cb81-25"><a href="#cb81-25"></a>ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</span>
<span id="cb81-26"><a href="#cb81-26"></a>  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</span>
<span id="cb81-27"><a href="#cb81-27"></a>  q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>] </span>
<span id="cb81-28"><a href="#cb81-28"></a>  d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</span>
<span id="cb81-29"><a href="#cb81-29"></a>  x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></span>
<span id="cb81-30"><a href="#cb81-30"></a>  y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></span>
<span id="cb81-31"><a href="#cb81-31"></a>  <span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb81-32"><a href="#cb81-32"></a>}</span>
<span id="cb81-33"><a href="#cb81-33"></a></span>
<span id="cb81-34"><a href="#cb81-34"></a><span class="co">#p-values of two models</span></span>
<span id="cb81-35"><a href="#cb81-35"></a>p_model1&lt;-<span class="cf">function</span>(n){</span>
<span id="cb81-36"><a href="#cb81-36"></a>   p.cor&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb81-37"><a href="#cb81-37"></a>   p.ball&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb81-38"><a href="#cb81-38"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb81-39"><a href="#cb81-39"></a>     N&lt;-n[i]</span>
<span id="cb81-40"><a href="#cb81-40"></a>     x1&lt;-<span class="kw">mvrnorm</span>(N,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>))</span>
<span id="cb81-41"><a href="#cb81-41"></a>     e1&lt;-<span class="kw">mvrnorm</span>(N,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>))</span>
<span id="cb81-42"><a href="#cb81-42"></a>     y1&lt;-x1<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e1</span>
<span id="cb81-43"><a href="#cb81-43"></a>     z1&lt;-<span class="kw">as.matrix</span>(<span class="kw">cbind</span>(x1,y1))</span>
<span id="cb81-44"><a href="#cb81-44"></a>     boot.obj1&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z1,<span class="dt">statistic =</span> ndCov2,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb81-45"><a href="#cb81-45"></a>     tb1&lt;-<span class="kw">c</span>(boot.obj1<span class="op">$</span>t0,boot.obj1<span class="op">$</span>t)</span>
<span id="cb81-46"><a href="#cb81-46"></a>     p.cor[i]&lt;-<span class="kw">mean</span>(tb1<span class="op">&gt;=</span>tb1[<span class="dv">1</span>])</span>
<span id="cb81-47"><a href="#cb81-47"></a>     p.ball[i]&lt;-<span class="kw">bcov.test</span>(x1,y1,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100000</span>,<span class="dt">size =</span> <span class="dv">1</span>))<span class="op">$</span>p.value</span>
<span id="cb81-48"><a href="#cb81-48"></a>   }</span>
<span id="cb81-49"><a href="#cb81-49"></a>   <span class="kw">return</span>(<span class="kw">c</span>(p.cor,p.ball))</span>
<span id="cb81-50"><a href="#cb81-50"></a>}</span>
<span id="cb81-51"><a href="#cb81-51"></a></span>
<span id="cb81-52"><a href="#cb81-52"></a>p_model2&lt;-<span class="cf">function</span>(n){</span>
<span id="cb81-53"><a href="#cb81-53"></a> p.cor&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb81-54"><a href="#cb81-54"></a> p.ball&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb81-55"><a href="#cb81-55"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb81-56"><a href="#cb81-56"></a>   N&lt;-n[i]</span>
<span id="cb81-57"><a href="#cb81-57"></a>   x2&lt;-<span class="kw">mvrnorm</span>(N,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>))</span>
<span id="cb81-58"><a href="#cb81-58"></a>   e2&lt;-<span class="kw">mvrnorm</span>(N,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>))</span>
<span id="cb81-59"><a href="#cb81-59"></a>   y2&lt;-<span class="kw">cbind</span>(x2[,<span class="dv">1</span>]<span class="op">*</span>e2[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">4</span>,x2[,<span class="dv">2</span>]<span class="op">*</span>e2[,<span class="dv">2</span>]<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb81-60"><a href="#cb81-60"></a>   z2&lt;-<span class="kw">as.matrix</span>(<span class="kw">cbind</span>(x2,y2))</span>
<span id="cb81-61"><a href="#cb81-61"></a>   boot.obj2&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z2,<span class="dt">statistic =</span> ndCov2,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb81-62"><a href="#cb81-62"></a>   tb2&lt;-<span class="kw">c</span>(boot.obj2<span class="op">$</span>t0,boot.obj2<span class="op">$</span>t)</span>
<span id="cb81-63"><a href="#cb81-63"></a>   p.cor[i]&lt;-<span class="kw">mean</span>(tb2<span class="op">&gt;=</span>tb2[<span class="dv">1</span>])</span>
<span id="cb81-64"><a href="#cb81-64"></a>   p.ball[i]&lt;-<span class="kw">bcov.test</span>(x2,y2,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100000</span>,<span class="dt">size =</span> <span class="dv">1</span>))<span class="op">$</span>p.value</span>
<span id="cb81-65"><a href="#cb81-65"></a> }</span>
<span id="cb81-66"><a href="#cb81-66"></a>  <span class="kw">return</span>(<span class="kw">c</span>(p.cor,p.ball))</span>
<span id="cb81-67"><a href="#cb81-67"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>n&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">5</span>),<span class="kw">seq</span>(<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">20</span>))</span>
<span id="cb82-2"><a href="#cb82-2"></a>m&lt;-<span class="dv">100</span></span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb82-4"><a href="#cb82-4"></a></span>
<span id="cb82-5"><a href="#cb82-5"></a><span class="co">#powers of two models</span></span>
<span id="cb82-6"><a href="#cb82-6"></a>pow1&lt;-<span class="kw">apply</span>(<span class="kw">replicate</span>(m,<span class="kw">p_model1</span>(n))<span class="op">&lt;=</span><span class="fl">0.05</span>,<span class="dv">1</span>,mean)</span>
<span id="cb82-7"><a href="#cb82-7"></a>pow2&lt;-<span class="kw">apply</span>(<span class="kw">replicate</span>(m,<span class="kw">p_model2</span>(n))<span class="op">&lt;=</span><span class="fl">0.05</span>,<span class="dv">1</span>,mean)</span>
<span id="cb82-8"><a href="#cb82-8"></a></span>
<span id="cb82-9"><a href="#cb82-9"></a><span class="co">#power comparison by plots</span></span>
<span id="cb82-10"><a href="#cb82-10"></a><span class="kw">plot</span>(n,pow1[<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)],<span class="dt">type =</span> <span class="st">&quot;o&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">main=</span><span class="st">&quot;power comparison of two methods for model 1&quot;</span>)</span>
<span id="cb82-11"><a href="#cb82-11"></a><span class="kw">lines</span>(n,pow1[(<span class="kw">length</span>(n)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">length</span>(n))],<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb82-12"><a href="#cb82-12"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;distance correlation test&quot;</span>,<span class="st">&quot;ball covariance test&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">cex=</span><span class="fl">0.7</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">pch=</span><span class="dv">1</span>)</span>
<span id="cb82-13"><a href="#cb82-13"></a><span class="kw">plot</span>(n,pow2[<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)],<span class="dt">type =</span> <span class="st">&quot;o&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">main=</span><span class="st">&quot;power comparison of two methods for model 2&quot;</span>)</span>
<span id="cb82-14"><a href="#cb82-14"></a><span class="kw">lines</span>(n,pow2[(<span class="kw">length</span>(n)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">length</span>(n))],<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb82-15"><a href="#cb82-15"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;distance correlation test&quot;</span>,<span class="st">&quot;ball covariance test&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">cex=</span><span class="fl">0.7</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">pch=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA4VBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZgBmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tma225C227a229u22/+2/9u2///bkDrbkGbbtmbbtpDb25Db27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v////PA0iRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANtElEQVR4nO2di3/bthHHYbl2JtVe0mbS5nVbF3nttmyzvO6RTKyTbjUVi///H1TcHUCCzwPfkHe/T+NS5OEAfHl4kRSlElGj1NwFCF0CiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYjQDoeKsuH7ulvF8p9dps/33ftxzgIVJndw02O7UoZ+MWIyxAsdJa4+anm4qStxJ56ALIKUZgTcypTWXJW4k8dAGUS6PU2Z9v1OK9+fhwrdRnb3Dzw6/15u90KDxt1PLDtTp7k3y/Uhd35Pbf+ugFpvpwo3m/vCPH4OsdRdD32tXZl+/zvsDmb/eK3BilB3dw5qhsuLn4LTrS21s8rVvXEahcMt08tIvX1tlin8/PSQ7t6OItAXKL6hQDrRXKNokdfVxjTewRXQzSNeWZmqGXONukJJc/IiCTHk9Q5stuOucoO1gC9E/4BNmvzbl2HBlAhZKZPRf7DFB1OXQ/kB5wi+oAsknV5fvkv3RIV/YXj582YHpYmVquTQkftOUb2gEudMzpPUvI6GePYL3G/MEX9kFwch/BRO93fMFfHXhR1sbzB/NNTB/bwh/KZ5mztYCKJdMFo9LYJgZlikrl0FVdPkK4LfZuUZ0mllpD5OZaZPTlu7Rx7sgBxdHlY5o3JrIN+Id/XEMdwBnsRkDa8OJdvqHbGNhi5svKg3lASCXCk4usXFsDKF8yvUnRv9hngLaJ2e8m39mAQ9dpUR1AxtoNdmf4sZtgC4SpvSe5k0OOjt9SHC7TAMC0FMLY3l1fxoacFTMqd9KRPrhTLzZnd1DnnK0BlC8ZRJttwW4njSZuckRvsnGK6gCy1gVA9rzaGkDXWAsIDoL3iz/9sCkC0qMslfQvOV8lQBUHHUCxOvvrRr25VeudabapbSWgWDUAKtfJZJMV1QFkLfpGEO14KgPSE5E/XmOP2COCtN0XKwifF9BGvCIo7TC4CMJtUxNbVCaC7Gl7+bbYB5UApX1QbPuUdQkQbH6TtXe3m8kANfZBNKJcPsZmdKvog/Ilc/yWAdX1QW5RM0BVfRAE32vsPbaFUawMyI5iaPfpttQH4YAIwUv9Z2GgcipSM4qZzRh7NxitgHnFKFYqmZ4UfdqQGU09svzKoxhUZO8W1ck7tXZnmru0w83Pg8qA7MwhnU8Um9i9M9/JzYMKgMoH7bkyA70+W0c6ATnbakBmHmQnaDhRzPJzkzt1cIvqnJzylC0xM+mvcRPnkV/XnKfFf/TghXNPGMUu3kZOCzFNDFypl+/zvioAlQ5SxN/jhEn7MlPQbcG2GlDy6duVLRh6yOfnJD9+t9JrBmpHblGdYtBMOumg/gul05EAYiSAGAkgRkFdDwpRAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGI0MCB1MpoL0FCOzs/PmR399oQIqFzYBlvzr36H3x4dKtU2AQIqF7/ZNmdd2uG3B4qjKm0mBtTUtE3glIvvGEyqOQA1uMPAMeWqK3BlopYRpNuSyvbQ2Tp3/hZShQHIVt/QSdq1Ma4PyvoXA6Bkg8fPc2UKqg+iwgCZ85Z8fEYxpfdgH5O161qbsp8QALnBc56F05A5sROa2uOBAMLgSdxeericEE7n4ocByOmge/PJxUIaOScMKMelf+tSidOqVG5PZ3/DGrZ0Z4NnUL+qGEZ9HQ5p2M6dGcB6OMrXvuUK08P/4Ibt3J3b/3r4Mb4cNOED2im1xG+IbWsMMkC9OuasRdmo6dfj1OUwpCEowm//41e01tUWzpytZwAVW9SgDWwkQMdb+C4jfRuv5vUl7qS2Tw80eMSUcxjaMIG4gXdo0DfCa77u43bSPaTG5jNvBPUe3tXgLaoqi4ENQWkfhKjq3KWLi66a4kbCjKNY3ynQyKFjcxnc0NtdzynQRPeh5gWUdAc01X26sQFFDaNYnyniZPcxZ71o33kQm6b7oawGN5zA3ZS3wU8R0JR8xgJkX2VS+7X5HlewJuUz1kTRvpcmVtxita2mxTPmUoPELlZbamo+Iy5WSdxitaUm53NaETRx90N5Dm4IiuwabNA+aAY8XQDVLtBd2XeD1r7tt0NlZ+HTAZDTwUyRb5pgHj5dmlhdvztOvh3tB1OXCFLMJHDQfDuZD6jTWGrMx+ckAM3V/VDmHQzxtcM7j7FsiHxnDZ82uTud9NldBG/c7UXIv9bz8uk4D4L5cd21wmHznbV5YQFaG8I8CAD1G+09850bT58I2nX8TYw2+c7Pp3sfFNXe8hou3wD4dB3FCu8G9s+uxZdoZu9+UOHOg4LAEyYgjK9A+HRbiy2bDHvni0+0hMKnSwQ5bzsfI1/kE0wAdW9iT5uR5kHK/heGugGCIBovglTj8YnVARD8AEHva2ZcH9TT/XDq0kmPeEWRvngSThfdrYk5P9k0cL5hBQ+qYycd1T9c5+iwqjXKu8t97SQsQqOMYull6/or16r4wfwLaQBDdQC04y/am/uFnhGk7N/nAUiHBz/CP23oN4g8ANmFhZ1Ah8VnvLXYTlP0AaTM0EV7ghrAUB1HMY95YqTWHoAoblQy/PeYBlKXC2bm9xO5Yeyw+swLkMoCJzw+HS+5guoebMl0vK2HmAHKhq9nAsg+vDDQRXvb/TwfQP4RhFbcPCj3NcpnAci7D6r0krsmnbs2Hd4IjxpvFOPdqfyVw/CGeNCM16QLK69srA9KIwHyeZA8v7AIcZkB6gII16KNXbTXg+T5qc8zAmS+jNrQCXk+BuyMWypctQZ0vKXhq+HevO+D5Fn24UWOVYeJ4i8pdBomiu0fJH9OgGwENU0UWz9I/pwA6UpD7Zsnim0fJH9OgDyup7bP9zkBGiVfAcS4E0CMOwHEuBNAjDsBxLjz8a4nYIdXNG14+k23J2yd9HYzVcGn/RggoLr1j52hJllF28qmq0pf2Gc/hgeo5tJrpC5udAT9eKvU+nir4DlktUwOX+ADgYcVTMliZR6qoI/aYJ0cXt4s/qX/7fGgrnVEL+65/Iiba+shQZ9odEyzaFXv0QE1L6UPV/vDSgN6WCZPv9rriur/YONqr//C8jBawjnfQZCZj1ew//D5XYL/8ODh1UdKBuk/kgF6SDBkyCi2WbSr98wRFOk1HVYQH72B0uswObvTG8c/3FFlYiAKSz/zcUkpHvEzHQQIJhmyJgPtgVIZozSLVvUeBlDdZRa2D7KAEAz8P17g+XcB2YeWKgEt6ciDTVYJyHgwWbSr98yjGLSEjS71d1CrNVUmthEEbSq+/Pj5HfXj5uOVQUHxhgeRSmwiKDVIAZFRZLNoV++5h/lInV3Dad3BJYKnzeX/NurFxp7/uk56m1hAiemkKZlOT500GhAgeCCFPNgsAuukA5UAYiSAGAkgRgKIkQBiFCCgypcHuktJXDA0u29czdas26s1EqC2L3lzPla/frIloEbVrNurNQ6g1i95UzW/eJQa6FU5zOFoCW8AOYt2WInof3QYFvCv6lf7dev2nvVuA6jXndWaCFpt6YIZLrQRUG7RbtdkcBgX7x/rV/s16/ae9W4DqP1L3vg+6GoPIWLW4gjIXZMm93eH10m6wk+cZXvlar9q3V6t8CKoWgTILuHLgOIl/Flk69OHxtV+1bq9WmP1QUPfm6cmZpfwaROzi/bk6auv9km6wk+cZXt5tV+zbvcq6ACGqMHvzVMn/WSW8IVOGmq9wx+pMCv8dNleudqvWbd7FXQAw07uZKLIuPv/BcQ+SN7L+wQK8Jp0WJImxkgAMQpvsRqYwlmsBqrZlhonozEAeSxWB8urlfFojluae0TQYHmdJCCPxepweZ0kIH6xOlxepwmonwTQkHkJoAGNBdBcjtub95IAeo4SQIwEECMBxEgAMRJAjAQQIwHESAAxEkCMBBAjAcRIADGaAhBdqIVneGLuJWnwxJlr15SAbH2c4/3OtbfjnKYABI9fouAdTnFTuczLmlO7pgTG1sP58VbvjgCil+O8pgBkb6LRbaNd/WvPY7qpndo1JTC2Ps7p3bPRYu/luKApAEXpo5WmoDV2sVpjdVO7hgTW1ts5Ptro4bioKQDtfk5dALWGxpuyBMjaNSeg/d7Od44/j5JYTQCInqbcrU2jb2z6WObUrjkB2no7h3udno5zmmyY19UZA5Cv89j20cECgvcHjNHE/JzTvfJAmxhJl8mja/TupJM8IMZ55P5aQXCdNJUmdkbZesXew3wOJuPcPnQR6jCPBYFfuOWnZ7H/RNGOYrzzw8o+ixLoRBF/sgPPYcRN8E2zSe2aEhhb3nlEj6TAQS/HOclilZEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiFDqgp83vN6rTT7wPpPABwVPyPX/kvY/CB7S2z9nNo/ABbXPvBptcAoiRAGIkgBgJIEYCiFHogGaXAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGPwH5ru6gwMDC3QAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From the plots,we can find that for model 1, the power of distance correlation test is bigger than ball covariance test. And for model 2, the power of ball covariance test is bigger than distance correlation test.</p>
</div>
</div>
</div>
<div id="hw-2019-11-29" class="section level1">
<h1>HW-2019-11-29</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>Exercise 9.4(pages 277, Statistical Computating with R)</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="exercises-9.4" class="section level3">
<h3>1. Exercises 9.4</h3>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2} e^{-|x|}, x \in \mathbb{R}\)</span>,so <span class="math inline">\(r\left(x_{t}, y\right)=\frac{f(Y)}{f\left(X_{t}\right)}=\frac{e^{-|y|}}{e^{-|x_{t}|}}=\frac{e^{|x_{t}|}}{e^{|y|}}\)</span>.</p>
<p>Then write a function to generate the chain,given the parameters <span class="math inline">\(\sigma\)</span>,initial value <span class="math inline">\(X_{0}\)</span> and the length of the chain N.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>rw.Metropolis&lt;-<span class="cf">function</span>(sigma,x0,N){</span>
<span id="cb83-2"><a href="#cb83-2"></a>   x&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb83-3"><a href="#cb83-3"></a>   x[<span class="dv">1</span>]&lt;-x0</span>
<span id="cb83-4"><a href="#cb83-4"></a>   u&lt;-<span class="kw">runif</span>(N)</span>
<span id="cb83-5"><a href="#cb83-5"></a>   k&lt;-<span class="dv">0</span></span>
<span id="cb83-6"><a href="#cb83-6"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb83-7"><a href="#cb83-7"></a>      y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb83-8"><a href="#cb83-8"></a>      <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>(<span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>]))<span class="op">/</span><span class="kw">exp</span>(<span class="kw">abs</span>(y)))) x[i]&lt;-y</span>
<span id="cb83-9"><a href="#cb83-9"></a>      <span class="cf">else</span>{</span>
<span id="cb83-10"><a href="#cb83-10"></a>         x[i]&lt;-x[i<span class="dv">-1</span>]</span>
<span id="cb83-11"><a href="#cb83-11"></a>         k&lt;-k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb83-12"><a href="#cb83-12"></a>      }</span>
<span id="cb83-13"><a href="#cb83-13"></a>   }</span>
<span id="cb83-14"><a href="#cb83-14"></a>   <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))</span>
<span id="cb83-15"><a href="#cb83-15"></a>}</span></code></pre></div>
<p>For diferent variances <span class="math inline">\(\sigma^{2}\)</span> of the proposal distribution ,we generate different chains:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>N&lt;-<span class="dv">2000</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>sigma&lt;-<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb84-3"><a href="#cb84-3"></a>x0&lt;-<span class="dv">20</span></span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb84-5"><a href="#cb84-5"></a>rw1&lt;-<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb84-6"><a href="#cb84-6"></a>rw2&lt;-<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb84-7"><a href="#cb84-7"></a>rw3&lt;-<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb84-8"><a href="#cb84-8"></a>rw4&lt;-<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb84-9"><a href="#cb84-9"></a></span>
<span id="cb84-10"><a href="#cb84-10"></a><span class="co">#par(mfrow=c(2,2)) #display 6 graphs together</span></span>
<span id="cb84-11"><a href="#cb84-11"></a><span class="co">#the 0.05 and 0.95 quantile of laplace distribution is log(0.1) and -log(0.1)</span></span>
<span id="cb84-12"><a href="#cb84-12"></a>refline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.1</span>),<span class="op">-</span><span class="kw">log</span>(<span class="fl">0.1</span>))</span>
<span id="cb84-13"><a href="#cb84-13"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</span>
<span id="cb84-14"><a href="#cb84-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb84-15"><a href="#cb84-15"></a> <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb84-16"><a href="#cb84-16"></a> <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb84-17"><a href="#cb84-17"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plots show that the random walk Metropolis sampler is very sensitive to the variance of the proposal distribution.From the plot,I prefer to choose <span class="math inline">\(\sigma=2\)</span> because the chain is mixing well and converging to the target distribution after a short period.</p>
<p>Then we compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>a&lt;-<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">c</span>(rw1<span class="op">$</span>k,rw2<span class="op">$</span>k,rw3<span class="op">$</span>k,rw4<span class="op">$</span>k)<span class="op">/</span>N,<span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="kw">colnames</span>(a)&lt;-<span class="kw">c</span>(<span class="st">&quot;σ = 0.05&quot;</span>,<span class="st">&quot;σ = 0.5&quot;</span>,<span class="st">&quot;σ = 2&quot;</span>,<span class="st">&quot;σ = 16&quot;</span>)</span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="kw">rownames</span>(a)&lt;-<span class="st">&quot;acceptance rate&quot;</span></span>
<span id="cb85-4"><a href="#cb85-4"></a><span class="kw">print</span>(a)</span></code></pre></div>
<pre><code>##                 σ = 0.05 σ = 0.5 σ = 2 σ = 16
## acceptance rate    0.984   0.809 0.523  0.115</code></pre>
<p>We want a chain which has a rejection rate in the range [0.15,0.5],that is,an acceptance rate in the range [0.5,0.85].So we would like to choose <span class="math inline">\(\sigma=2\)</span>.</p>
<p>When <span class="math inline">\(\sigma=2\)</span>,we compare the quantiles of the target distribution with the quantiles of the generated chain in a Q-Q plot.And we compare the histogram of the generated sample with the Laplace distribution density.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co">#par(mfrow=c(1,2)) </span></span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="co">#histogram</span></span>
<span id="cb87-3"><a href="#cb87-3"></a>x&lt;-rw3<span class="op">$</span>x</span>
<span id="cb87-4"><a href="#cb87-4"></a>x&lt;-x[x<span class="op">&gt;-</span><span class="dv">10</span><span class="op">&amp;</span>x<span class="op">&lt;</span><span class="dv">10</span>]</span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="kw">hist</span>(x,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.5</span>),<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb87-6"><a href="#cb87-6"></a>laplace&lt;-<span class="cf">function</span>(x) <span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb87-7"><a href="#cb87-7"></a><span class="kw">curve</span>(laplace,<span class="dt">from=</span><span class="op">-</span><span class="dv">10</span>,<span class="dt">to=</span><span class="dv">10</span>,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="co">#Q-Q plot</span></span>
<span id="cb88-2"><a href="#cb88-2"></a>a&lt;-<span class="kw">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb88-3"><a href="#cb88-3"></a>y&lt;-rw3<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>]</span>
<span id="cb88-4"><a href="#cb88-4"></a>Q&lt;-<span class="kw">quantile</span>(y,a)</span>
<span id="cb88-5"><a href="#cb88-5"></a>QL&lt;-<span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>a[a<span class="op">&lt;=</span><span class="fl">0.5</span>]),<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a[a<span class="op">&gt;</span><span class="fl">0.5</span>]))) <span class="co">#quantiles of Laplace</span></span>
<span id="cb88-6"><a href="#cb88-6"></a><span class="kw">qqplot</span>(QL,Q,<span class="dt">xlab=</span><span class="st">&quot;Laplace quantiles&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Sample quantiles&quot;</span>)</span>
<span id="cb88-7"><a href="#cb88-7"></a><span class="kw">lines</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot, we can see that the generated samples fit well.</p>
</div>
</div>
</div>
<div id="hw-2019-12-06" class="section level1">
<h1>HW-2019-12-06</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>Exercise 11.1 and 11.5(Statistical Computating with R pages 353-354),A-B-0 blood type problem.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="exercises-11.1" class="section level3">
<h3>1. Exercises 11.1</h3>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(log x) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
<p>First use “isTRUE” to compare them.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>x&lt;-<span class="dv">5</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="kw">c</span>(<span class="kw">isTRUE</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x))<span class="op">==</span><span class="kw">exp</span>(<span class="kw">log</span>(x))),<span class="kw">isTRUE</span>(<span class="kw">exp</span>(<span class="kw">log</span>(x))<span class="op">==</span>x))</span></code></pre></div>
<pre><code>## [1] FALSE FALSE</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>x&lt;-<span class="dv">10</span></span>
<span id="cb91-2"><a href="#cb91-2"></a><span class="kw">c</span>(<span class="kw">isTRUE</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x))<span class="op">==</span><span class="kw">exp</span>(<span class="kw">log</span>(x))),<span class="kw">isTRUE</span>(<span class="kw">exp</span>(<span class="kw">log</span>(x))<span class="op">==</span>x))</span></code></pre></div>
<pre><code>## [1] FALSE FALSE</code></pre>
<p>For different x,the equations log(exp(x))=exp(log(x)) and exp(log(x))=x don’t hold exactly in computer arithmetic.</p>
<p>Then use “all.equal” to compare.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>x&lt;-<span class="dv">5</span></span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="kw">c</span>(<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x)),<span class="kw">exp</span>(<span class="kw">log</span>(x)))),<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">exp</span>(<span class="kw">log</span>(x)),x)))</span></code></pre></div>
<pre><code>## [1] TRUE TRUE</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>x&lt;-<span class="dv">10</span></span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="kw">c</span>(<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x)),<span class="kw">exp</span>(<span class="kw">log</span>(x)))),<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">exp</span>(<span class="kw">log</span>(x)),x)))</span></code></pre></div>
<pre><code>## [1] TRUE TRUE</code></pre>
<p>When using “all.equal” function,the identity holds.</p>
</div>
<div id="exercise-11.5" class="section level3">
<h3>2. Exercise 11.5</h3>
<p>Write a function to solve the equation <span class="math display">\[\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u =\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \]</span> for a, where <span class="math inline">\(c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\)</span>.Compare the solutions with the points A(k) in Exercise 11.4.</p>
<p>Use bisection algorithm to solve the equation in exercise 11.5.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="co">#exercise 11.5</span></span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb97-3"><a href="#cb97-3"></a>ck&lt;-<span class="cf">function</span>(k,a) <span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb97-4"><a href="#cb97-4"></a>f1&lt;-<span class="cf">function</span>(k) <span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(k<span class="dv">-1</span>)</span>
<span id="cb97-5"><a href="#cb97-5"></a>f&lt;-<span class="cf">function</span>(u)  (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb97-6"><a href="#cb97-6"></a>f2&lt;-<span class="cf">function</span>(c,k) <span class="kw">integrate</span>(f,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span>c)<span class="op">$</span>value</span>
<span id="cb97-7"><a href="#cb97-7"></a>root&lt;-<span class="cf">function</span>(k){</span>
<span id="cb97-8"><a href="#cb97-8"></a>   it&lt;-<span class="dv">0</span></span>
<span id="cb97-9"><a href="#cb97-9"></a>   r&lt;-<span class="kw">seq</span>(<span class="fl">1e-5</span>,<span class="kw">sqrt</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>,<span class="dt">length=</span><span class="dv">3</span>)</span>
<span id="cb97-10"><a href="#cb97-10"></a>   y&lt;-<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb97-11"><a href="#cb97-11"></a>   y[<span class="dv">1</span>]&lt;-<span class="kw">f1</span>(k)<span class="op">*</span><span class="kw">f2</span>(<span class="kw">ck</span>(k,r[<span class="dv">1</span>]),k)<span class="op">-</span><span class="kw">f1</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">f2</span>(<span class="kw">ck</span>(k<span class="op">+</span><span class="dv">1</span>,r[<span class="dv">1</span>]),k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb97-12"><a href="#cb97-12"></a>   y[<span class="dv">2</span>]&lt;-<span class="kw">f1</span>(k)<span class="op">*</span><span class="kw">f2</span>(<span class="kw">ck</span>(k,r[<span class="dv">2</span>]),k)<span class="op">-</span><span class="kw">f1</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">f2</span>(<span class="kw">ck</span>(k<span class="op">+</span><span class="dv">1</span>,r[<span class="dv">2</span>]),k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb97-13"><a href="#cb97-13"></a>   y[<span class="dv">3</span>]&lt;-<span class="kw">f1</span>(k)<span class="op">*</span><span class="kw">f2</span>(<span class="kw">ck</span>(k,r[<span class="dv">3</span>]),k)<span class="op">-</span><span class="kw">f1</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">f2</span>(<span class="kw">ck</span>(k<span class="op">+</span><span class="dv">1</span>,r[<span class="dv">3</span>]),k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb97-14"><a href="#cb97-14"></a>   <span class="cf">while</span>(it<span class="op">&lt;</span><span class="dv">1000</span>){</span>
<span id="cb97-15"><a href="#cb97-15"></a>      it&lt;-it<span class="op">+</span><span class="dv">1</span></span>
<span id="cb97-16"><a href="#cb97-16"></a>      <span class="cf">if</span>(y[<span class="dv">1</span>]<span class="op">*</span>y[<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>){</span>
<span id="cb97-17"><a href="#cb97-17"></a>         r[<span class="dv">3</span>]&lt;-r[<span class="dv">2</span>]</span>
<span id="cb97-18"><a href="#cb97-18"></a>         y[<span class="dv">3</span>]&lt;-y[<span class="dv">2</span>]</span>
<span id="cb97-19"><a href="#cb97-19"></a>      } <span class="cf">else</span> {</span>
<span id="cb97-20"><a href="#cb97-20"></a>         r[<span class="dv">1</span>]&lt;-r[<span class="dv">2</span>]</span>
<span id="cb97-21"><a href="#cb97-21"></a>         y[<span class="dv">1</span>]&lt;-y[<span class="dv">2</span>]</span>
<span id="cb97-22"><a href="#cb97-22"></a>      }</span>
<span id="cb97-23"><a href="#cb97-23"></a>      r[<span class="dv">2</span>]&lt;-(r[<span class="dv">1</span>]<span class="op">+</span>r[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb97-24"><a href="#cb97-24"></a>      y[<span class="dv">2</span>]&lt;-<span class="kw">f1</span>(k)<span class="op">*</span><span class="kw">f2</span>(<span class="kw">ck</span>(k,r[<span class="dv">2</span>]),k)<span class="op">-</span><span class="kw">f1</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">f2</span>(<span class="kw">ck</span>(k<span class="op">+</span><span class="dv">1</span>,r[<span class="dv">2</span>]),k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb97-25"><a href="#cb97-25"></a>   }</span>
<span id="cb97-26"><a href="#cb97-26"></a>   <span class="kw">return</span>(r[<span class="dv">2</span>])</span>
<span id="cb97-27"><a href="#cb97-27"></a>}</span>
<span id="cb97-28"><a href="#cb97-28"></a>K&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>)</span>
<span id="cb97-29"><a href="#cb97-29"></a>a1&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(K))</span>
<span id="cb97-30"><a href="#cb97-30"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(K)) {</span>
<span id="cb97-31"><a href="#cb97-31"></a>   k&lt;-K[i]</span>
<span id="cb97-32"><a href="#cb97-32"></a>   a1[i]&lt;-<span class="kw">root</span>(k)</span>
<span id="cb97-33"><a href="#cb97-33"></a>}</span>
<span id="cb97-34"><a href="#cb97-34"></a><span class="kw">print</span>(<span class="kw">round</span>(a1,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##  [1] 1.118 1.225 1.323 1.414 1.500 1.534 1.523 1.513 1.506 1.499 1.493 1.488
## [13] 1.484 1.481 1.477 1.474 1.472 1.469 1.467 1.465 1.463 1.462</code></pre>
<p>Compute the points A(k) in exercise 11.4.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="co">#exercise 11.4</span></span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb99-3"><a href="#cb99-3"></a>s&lt;-<span class="cf">function</span>(k,a) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k)</span>
<span id="cb99-4"><a href="#cb99-4"></a>root2&lt;-<span class="cf">function</span>(k){</span>
<span id="cb99-5"><a href="#cb99-5"></a>   it&lt;-<span class="dv">0</span></span>
<span id="cb99-6"><a href="#cb99-6"></a>   r&lt;-<span class="kw">seq</span>(<span class="fl">1e-5</span>,<span class="kw">sqrt</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>,<span class="dt">length=</span><span class="dv">3</span>)</span>
<span id="cb99-7"><a href="#cb99-7"></a>   y&lt;-<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb99-8"><a href="#cb99-8"></a>   y[<span class="dv">1</span>]&lt;-<span class="kw">s</span>(k<span class="dv">-1</span>,r[<span class="dv">1</span>])<span class="op">-</span><span class="kw">s</span>(k,r[<span class="dv">1</span>])</span>
<span id="cb99-9"><a href="#cb99-9"></a>   y[<span class="dv">2</span>]&lt;-<span class="kw">s</span>(k<span class="dv">-1</span>,r[<span class="dv">2</span>])<span class="op">-</span><span class="kw">s</span>(k,r[<span class="dv">2</span>])</span>
<span id="cb99-10"><a href="#cb99-10"></a>   y[<span class="dv">3</span>]&lt;-<span class="kw">s</span>(k<span class="dv">-1</span>,r[<span class="dv">3</span>])<span class="op">-</span><span class="kw">s</span>(k,r[<span class="dv">3</span>])</span>
<span id="cb99-11"><a href="#cb99-11"></a>   <span class="cf">while</span>(it<span class="op">&lt;</span><span class="dv">1000</span>){</span>
<span id="cb99-12"><a href="#cb99-12"></a>      it&lt;-it<span class="op">+</span><span class="dv">1</span></span>
<span id="cb99-13"><a href="#cb99-13"></a>      <span class="cf">if</span>(y[<span class="dv">1</span>]<span class="op">*</span>y[<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>){</span>
<span id="cb99-14"><a href="#cb99-14"></a>         r[<span class="dv">3</span>]&lt;-r[<span class="dv">2</span>]</span>
<span id="cb99-15"><a href="#cb99-15"></a>         y[<span class="dv">3</span>]&lt;-y[<span class="dv">2</span>]</span>
<span id="cb99-16"><a href="#cb99-16"></a>      } <span class="cf">else</span> {</span>
<span id="cb99-17"><a href="#cb99-17"></a>         r[<span class="dv">1</span>]&lt;-r[<span class="dv">2</span>]</span>
<span id="cb99-18"><a href="#cb99-18"></a>         y[<span class="dv">1</span>]&lt;-y[<span class="dv">2</span>]</span>
<span id="cb99-19"><a href="#cb99-19"></a>      }</span>
<span id="cb99-20"><a href="#cb99-20"></a>      r[<span class="dv">2</span>]&lt;-(r[<span class="dv">1</span>]<span class="op">+</span>r[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb99-21"><a href="#cb99-21"></a>      y[<span class="dv">2</span>]&lt;-<span class="kw">s</span>(k<span class="dv">-1</span>,r[<span class="dv">2</span>])<span class="op">-</span><span class="kw">s</span>(k,r[<span class="dv">2</span>])</span>
<span id="cb99-22"><a href="#cb99-22"></a>   }</span>
<span id="cb99-23"><a href="#cb99-23"></a>   <span class="kw">return</span>(r[<span class="dv">2</span>])</span>
<span id="cb99-24"><a href="#cb99-24"></a>}</span>
<span id="cb99-25"><a href="#cb99-25"></a>K&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>)</span>
<span id="cb99-26"><a href="#cb99-26"></a>a2&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(K))</span>
<span id="cb99-27"><a href="#cb99-27"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(K)) {</span>
<span id="cb99-28"><a href="#cb99-28"></a>   a2[i]&lt;-<span class="kw">root2</span>(K[i])</span>
<span id="cb99-29"><a href="#cb99-29"></a>}</span>
<span id="cb99-30"><a href="#cb99-30"></a><span class="kw">print</span>(<span class="kw">round</span>(a2,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##  [1] 1.118 1.225 1.323 1.414 1.500 1.581 1.625 1.634 1.642 1.649 1.654 1.659
## [13] 1.663 1.667 1.671 1.674 1.677 1.679 1.681 1.684 1.686 1.687</code></pre>
<p>Compare the solutions in exercise 11.5 with the points A(k) in exercise 11.4.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">22</span>,a1,<span class="dt">main=</span><span class="st">&quot;solution comparison&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;k&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;roots&quot;</span>,<span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;o&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="kw">lines</span>(a2,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb101-3"><a href="#cb101-3"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="dv">22</span>,<span class="dt">labels =</span> K)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="a-b-o-blood-type-problem" class="section level3">
<h3>A-B-O blood type problem</h3>
<p>Let the three alleles be A,B and O with allele frequencies p,q and r.The 6 genotype frequencies under HWE and complete counts are as follows.</p>
<pre><code>##           [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## genotype  AA   BB   OO   AO   BO   AB   Sum 
## frequency p^2  q^2  r^2  2pr  2qr  2pq  1   
## Count     nAA  nBB  nOO  nAO  nBO  nAB  n</code></pre>
<p>Observed data: <span class="math inline">\(n_{A.}=n_{AA}+n_{AO}=28\)</span> (A-type), <span class="math inline">\(n_{B.}=n_{BB}+n_{BO}=24\)</span> (B-type), <span class="math inline">\(n_{OO}=41\)</span> (O-type), <span class="math inline">\(n_{AB}=70\)</span> (AB-type).</p>
<p>Use EM algorithm to solve MLE of p and q(consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co">#observed data loglikelihood</span></span>
<span id="cb103-2"><a href="#cb103-2"></a>L&lt;-<span class="cf">function</span>(nA,nB,nAB,nOO,p,q,r){</span>
<span id="cb103-3"><a href="#cb103-3"></a>   nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="op">+</span>nA<span class="op">*</span><span class="kw">log</span>(p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>nB<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span>nOO<span class="op">*</span><span class="kw">log</span>(r<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb103-4"><a href="#cb103-4"></a>}</span>
<span id="cb103-5"><a href="#cb103-5"></a></span>
<span id="cb103-6"><a href="#cb103-6"></a>em&lt;-<span class="cf">function</span>(P,n.obs){</span>
<span id="cb103-7"><a href="#cb103-7"></a>  n&lt;-<span class="kw">sum</span>(n.obs)</span>
<span id="cb103-8"><a href="#cb103-8"></a>  nA&lt;-n.obs[<span class="dv">1</span>]</span>
<span id="cb103-9"><a href="#cb103-9"></a>  nB&lt;-n.obs[<span class="dv">2</span>]</span>
<span id="cb103-10"><a href="#cb103-10"></a>  nOO&lt;-n.obs[<span class="dv">3</span>]</span>
<span id="cb103-11"><a href="#cb103-11"></a>  nAB&lt;-n.obs[<span class="dv">4</span>]</span>
<span id="cb103-12"><a href="#cb103-12"></a>  </span>
<span id="cb103-13"><a href="#cb103-13"></a>  l&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">14</span>)</span>
<span id="cb103-14"><a href="#cb103-14"></a>  p&lt;-q&lt;-r&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">15</span>)</span>
<span id="cb103-15"><a href="#cb103-15"></a>  p[<span class="dv">1</span>]&lt;-P[<span class="dv">1</span>]</span>
<span id="cb103-16"><a href="#cb103-16"></a>  q[<span class="dv">1</span>]&lt;-P[<span class="dv">2</span>]</span>
<span id="cb103-17"><a href="#cb103-17"></a>  r[<span class="dv">1</span>]&lt;-<span class="dv">1</span><span class="op">-</span>P[<span class="dv">1</span>]<span class="op">-</span>P[<span class="dv">2</span>]</span>
<span id="cb103-18"><a href="#cb103-18"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">15</span>){</span>
<span id="cb103-19"><a href="#cb103-19"></a></span>
<span id="cb103-20"><a href="#cb103-20"></a>    p.old&lt;-p[i<span class="dv">-1</span>]</span>
<span id="cb103-21"><a href="#cb103-21"></a>    q.old&lt;-q[i<span class="dv">-1</span>]</span>
<span id="cb103-22"><a href="#cb103-22"></a>    r.old&lt;-r[i<span class="dv">-1</span>]</span>
<span id="cb103-23"><a href="#cb103-23"></a>  </span>
<span id="cb103-24"><a href="#cb103-24"></a>    nAA&lt;-nA<span class="op">*</span>p.old<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p.old<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p.old<span class="op">*</span>r.old)</span>
<span id="cb103-25"><a href="#cb103-25"></a>    nBB&lt;-nB<span class="op">*</span>q.old<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q.old<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q.old<span class="op">*</span>r.old)</span>
<span id="cb103-26"><a href="#cb103-26"></a>    nAO&lt;-nA<span class="op">-</span>nAA</span>
<span id="cb103-27"><a href="#cb103-27"></a>    nBO&lt;-nB<span class="op">-</span>nBB</span>
<span id="cb103-28"><a href="#cb103-28"></a>  </span>
<span id="cb103-29"><a href="#cb103-29"></a>    p[i]&lt;-(<span class="dv">2</span><span class="op">*</span>nAA<span class="op">+</span>nAB<span class="op">+</span>nAO)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb103-30"><a href="#cb103-30"></a>    q[i]&lt;-(<span class="dv">2</span><span class="op">*</span>nBB<span class="op">+</span>nAB<span class="op">+</span>nBO)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb103-31"><a href="#cb103-31"></a>    r[i]&lt;-(<span class="dv">2</span><span class="op">*</span>nOO<span class="op">+</span>nAO<span class="op">+</span>nBO)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb103-32"><a href="#cb103-32"></a>    l[i<span class="dv">-1</span>]&lt;-<span class="kw">L</span>(nA,nB,nAB,nOO,p[i],q[i],r[i])</span>
<span id="cb103-33"><a href="#cb103-33"></a>  }</span>
<span id="cb103-34"><a href="#cb103-34"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">p=</span>p,<span class="dt">q=</span>q,<span class="dt">r=</span>r,<span class="dt">l=</span>l))</span>
<span id="cb103-35"><a href="#cb103-35"></a>}</span>
<span id="cb103-36"><a href="#cb103-36"></a>n.obs=<span class="kw">c</span>(<span class="dv">28</span>,<span class="dv">24</span>,<span class="dv">41</span>,<span class="dv">70</span>)</span>
<span id="cb103-37"><a href="#cb103-37"></a>P&lt;-<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>)</span>
<span id="cb103-38"><a href="#cb103-38"></a>a&lt;-<span class="kw">em</span>(P,n.obs)</span>
<span id="cb103-39"><a href="#cb103-39"></a><span class="kw">print</span>(<span class="kw">rbind</span>(a<span class="op">$</span>p,a<span class="op">$</span>q,a<span class="op">$</span>r))</span></code></pre></div>
<pre><code>##      [,1]      [,2]      [,3]     [,4]      [,5]      [,6]      [,7]      [,8]
## [1,]  0.1 0.3056658 0.3242869 0.326897 0.3272785 0.3273346 0.3273428 0.3273440
## [2,]  0.1 0.2926741 0.3080029 0.310075 0.3103751 0.3104191 0.3104256 0.3104265
## [3,]  0.8 0.4016601 0.3677101 0.363028 0.3623463 0.3622463 0.3622316 0.3622294
##           [,9]     [,10]     [,11]     [,12]     [,13]     [,14]     [,15]
## [1,] 0.3273442 0.3273442 0.3273442 0.3273442 0.3273442 0.3273442 0.3273442
## [2,] 0.3104267 0.3104267 0.3104267 0.3104267 0.3104267 0.3104267 0.3104267
## [3,] 0.3622291 0.3622291 0.3622291 0.3622291 0.3622291 0.3622291 0.3622291</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>,a<span class="op">$</span>l,<span class="dt">main=</span><span class="st">&quot;log-maximum likelihood values&quot;</span>,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;step&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;l values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw-2019-12-13" class="section level1">
<h1>HW-2019-12-13</h1>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>Exercise 3,4,5(pages 204,Advanced R) and Exercise 3,7(pages 214,Advanced R)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="exercise-3pages-204advanced-r" class="section level3">
<h3>1. Exercise 3(pages 204,Advanced R)</h3>
<p>Use both for loops and lapply() to fit linear models to the <span class="math inline">\(mtcars\)</span> using the formulas stored in the list:</p>
<p>formulas &lt;- list(mpg ~ disp,mpg ~ I(1 / disp),mpg ~ disp + wt,mpg ~ I(1 / disp) + wt)</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(mpg <span class="op">~</span><span class="st"> </span>disp,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</span>
<span id="cb106-2"><a href="#cb106-2"></a></span>
<span id="cb106-3"><a href="#cb106-3"></a><span class="co">#for loop</span></span>
<span id="cb106-4"><a href="#cb106-4"></a>lm1&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(formulas))</span>
<span id="cb106-5"><a href="#cb106-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){</span>
<span id="cb106-6"><a href="#cb106-6"></a>  lm1[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]],<span class="dt">data =</span> mtcars)</span>
<span id="cb106-7"><a href="#cb106-7"></a>}</span>
<span id="cb106-8"><a href="#cb106-8"></a>lm1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="co">#lapply()</span></span>
<span id="cb108-2"><a href="#cb108-2"></a>lm2&lt;-<span class="kw">lapply</span>(<span class="kw">seq_along</span>(formulas),<span class="cf">function</span>(i) <span class="kw">lm</span>(formulas[[i]],<span class="dt">data =</span> mtcars))</span>
<span id="cb108-3"><a href="#cb108-3"></a>lm2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="exercise-4pages-204advanced-r" class="section level3">
<h3>2. Exercise 4(pages 204,Advanced R)</h3>
<p>Fit the model <span class="math inline">\(mpg \sim disp\)</span> to each of the bootstrap replicates of <span class="math inline">\(mtcars\)</span> in the list below by using a for loop and <span class="math inline">\(lapply()\)</span>. Can you do it without an anonymous function?</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a>bootstraps&lt;-<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i){</span>
<span id="cb110-2"><a href="#cb110-2"></a>   rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb110-3"><a href="#cb110-3"></a>   mtcars[rows, ]</span>
<span id="cb110-4"><a href="#cb110-4"></a>})</span>
<span id="cb110-5"><a href="#cb110-5"></a></span>
<span id="cb110-6"><a href="#cb110-6"></a><span class="co">#for loop</span></span>
<span id="cb110-7"><a href="#cb110-7"></a>l1&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(bootstraps))</span>
<span id="cb110-8"><a href="#cb110-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){</span>
<span id="cb110-9"><a href="#cb110-9"></a>  l1[[i]]&lt;-<span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data =</span> bootstraps[[i]])</span>
<span id="cb110-10"><a href="#cb110-10"></a>}</span>
<span id="cb110-11"><a href="#cb110-11"></a>l1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.5373      -0.0444  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.22675     -0.04133  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.82696     -0.03348  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    32.01974     -0.05052  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.29851     -0.03386  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.92822     -0.04303  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.00863     -0.03565  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.42554     -0.03894  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.46265     -0.04743  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.04377     -0.03652</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co">#lapply() </span></span>
<span id="cb112-2"><a href="#cb112-2"></a><span class="co">#do it without an anonymous function</span></span>
<span id="cb112-3"><a href="#cb112-3"></a>l2&lt;-<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</span>
<span id="cb112-4"><a href="#cb112-4"></a>l2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.5373      -0.0444  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.22675     -0.04133  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.82696     -0.03348  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    32.01974     -0.05052  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.29851     -0.03386  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.92822     -0.04303  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.00863     -0.03565  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.42554     -0.03894  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.46265     -0.04743  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.04377     -0.03652</code></pre>
</div>
<div id="exercise-5pages-204advanced-r" class="section level3">
<h3>3. Exercise 5(pages 204,Advanced R)</h3>
<p>For each model in the previous two exercises, extract R2 using the function below.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</span>
<span id="cb114-2"><a href="#cb114-2"></a></span>
<span id="cb114-3"><a href="#cb114-3"></a><span class="co">#model in exercise 3</span></span>
<span id="cb114-4"><a href="#cb114-4"></a><span class="kw">unlist</span>(<span class="kw">lapply</span>(lm1, rsq))</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="kw">unlist</span>(<span class="kw">lapply</span>(lm2, rsq))</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="co">#model in exercise 4</span></span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="kw">unlist</span>(<span class="kw">lapply</span>(l1, rsq))</span></code></pre></div>
<pre><code>##  [1] 0.7817567 0.7813869 0.7191574 0.7880896 0.6350857 0.8092306 0.7153903
##  [8] 0.7117518 0.6652465 0.5906548</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="kw">unlist</span>(<span class="kw">lapply</span>(l2, rsq))</span></code></pre></div>
<pre><code>##  [1] 0.7817567 0.7813869 0.7191574 0.7880896 0.6350857 0.8092306 0.7153903
##  [8] 0.7117518 0.6652465 0.5906548</code></pre>
</div>
<div id="exercise-3pages-214advanced-r" class="section level3">
<h3>4. Exercise 3(pages 214,Advanced R)</h3>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">10</span>),<span class="kw">rpois</span>(<span class="dv">7</span>,<span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb122-2"><a href="#cb122-2"></a><span class="co">#extract the p-value from every trial</span></span>
<span id="cb122-3"><a href="#cb122-3"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.25399172 0.95218057 0.96707126 0.73271297 0.23954469 0.44304177
##   [7] 0.82505300 0.47834643 0.83398501 0.28677782 0.32393591 0.58791171
##  [13] 0.37458782 0.03154822 0.27660703 0.81121328 0.07632266 0.74697953
##  [19] 0.89136198 0.19807802 0.03540943 0.46477246 0.31975085 0.36182827
##  [25] 0.47581765 0.24912119 0.77474406 0.77993677 0.78478879 0.59772964
##  [31] 0.71182391 0.21963120 0.69764942 0.66074430 0.44745990 0.29311517
##  [37] 0.81813960 0.91968642 0.62447455 0.28125422 0.12250357 0.16645727
##  [43] 0.86882267 0.92936738 0.23221383 0.20957034 0.45833984 0.82747566
##  [49] 0.96756786 0.98661304 0.86258363 0.03316359 0.44381805 0.12746016
##  [55] 0.75113209 0.49926890 0.32179203 0.06133945 0.88494487 0.66133103
##  [61] 0.08801281 0.20429664 0.31167672 0.04419619 0.48452025 0.81078022
##  [67] 0.36775963 0.74381327 0.15836056 0.05247675 0.81546092 0.95110556
##  [73] 0.50694686 0.82575616 0.84425564 0.22694392 0.58506727 0.05643706
##  [79] 0.05498503 0.74416657 0.86663861 0.16153192 0.98258238 0.28634770
##  [85] 0.38472659 0.18999235 0.53462651 0.58950555 0.32413849 0.57679670
##  [91] 0.60003972 0.38698635 0.50620011 0.58789266 0.26624001 0.14471008
##  [97] 0.66409688 0.04803668 0.75139328 0.77114599</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="co">#Extra challenge: get rid of the anonymous function by using [[ directly.</span></span>
<span id="cb124-2"><a href="#cb124-2"></a><span class="kw">sapply</span>(trials,<span class="st">&#39;[[&#39;</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   [1] 0.25399172 0.95218057 0.96707126 0.73271297 0.23954469 0.44304177
##   [7] 0.82505300 0.47834643 0.83398501 0.28677782 0.32393591 0.58791171
##  [13] 0.37458782 0.03154822 0.27660703 0.81121328 0.07632266 0.74697953
##  [19] 0.89136198 0.19807802 0.03540943 0.46477246 0.31975085 0.36182827
##  [25] 0.47581765 0.24912119 0.77474406 0.77993677 0.78478879 0.59772964
##  [31] 0.71182391 0.21963120 0.69764942 0.66074430 0.44745990 0.29311517
##  [37] 0.81813960 0.91968642 0.62447455 0.28125422 0.12250357 0.16645727
##  [43] 0.86882267 0.92936738 0.23221383 0.20957034 0.45833984 0.82747566
##  [49] 0.96756786 0.98661304 0.86258363 0.03316359 0.44381805 0.12746016
##  [55] 0.75113209 0.49926890 0.32179203 0.06133945 0.88494487 0.66133103
##  [61] 0.08801281 0.20429664 0.31167672 0.04419619 0.48452025 0.81078022
##  [67] 0.36775963 0.74381327 0.15836056 0.05247675 0.81546092 0.95110556
##  [73] 0.50694686 0.82575616 0.84425564 0.22694392 0.58506727 0.05643706
##  [79] 0.05498503 0.74416657 0.86663861 0.16153192 0.98258238 0.28634770
##  [85] 0.38472659 0.18999235 0.53462651 0.58950555 0.32413849 0.57679670
##  [91] 0.60003972 0.38698635 0.50620011 0.58789266 0.26624001 0.14471008
##  [97] 0.66409688 0.04803668 0.75139328 0.77114599</code></pre>
</div>
<div id="exercise-7pages-214advanced-r" class="section level3">
<h3>5. Exercise 7(pages 214,Advanced R)</h3>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="co">#Implement mcsapply()</span></span>
<span id="cb126-2"><a href="#cb126-2"></a><span class="kw">library</span>(parallel)</span>
<span id="cb126-3"><a href="#cb126-3"></a>num_cores =<span class="st"> </span><span class="kw">detectCores</span>()</span>
<span id="cb126-4"><a href="#cb126-4"></a>cluster =<span class="st"> </span><span class="kw">makePSOCKcluster</span>(num_cores)</span>
<span id="cb126-5"><a href="#cb126-5"></a>mcsapply =<span class="st"> </span><span class="cf">function</span>(cluster,X,FUN,...){</span>
<span id="cb126-6"><a href="#cb126-6"></a> res =<span class="st"> </span><span class="kw">parLapply</span>(cluster,X,FUN,...) </span>
<span id="cb126-7"><a href="#cb126-7"></a> <span class="kw">simplify2array</span>(res)</span>
<span id="cb126-8"><a href="#cb126-8"></a>}</span>
<span id="cb126-9"><a href="#cb126-9"></a>fun &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">return</span> (x<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb126-10"><a href="#cb126-10"></a><span class="kw">system.time</span>(res &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5000000</span>,fun))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    6.33    0.10    7.27</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="kw">system.time</span>(res &lt;-<span class="st"> </span><span class="kw">mcsapply</span>(cluster,<span class="dv">1</span><span class="op">:</span><span class="dv">5000000</span>,fun))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    1.88    0.14    3.73</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="kw">stopCluster</span>(cluster)</span></code></pre></div>
<p>I can’t implement mcvapply(),a parallel version of vapply(),because the vapply function didn’t use lapply(),I can’t implement a parallel version of vapply() in R.</p>
</div>
</div>
</div>
<div id="hw-2019-12-20" class="section level1">
<h1>HW-2019-12-20</h1>
<div id="question-11" class="section level2">
<h2>Question</h2>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task.</p>
<p>Compare the generated random numbers by the two functions using <span class="math inline">\(qqplot\)</span>.</p>
<p>Compare the computation time of the two functions with <span class="math inline">\(microbenchmark\)</span>.</p>
<p>Comments your results.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="co">## R function for Exercise 9.4</span></span>
<span id="cb131-2"><a href="#cb131-2"></a>rw.Metropolis&lt;-<span class="cf">function</span>(sigma,x0,N){</span>
<span id="cb131-3"><a href="#cb131-3"></a>   x&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb131-4"><a href="#cb131-4"></a>   x[<span class="dv">1</span>]&lt;-x0</span>
<span id="cb131-5"><a href="#cb131-5"></a>   u&lt;-<span class="kw">runif</span>(N)</span>
<span id="cb131-6"><a href="#cb131-6"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb131-7"><a href="#cb131-7"></a>      y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb131-8"><a href="#cb131-8"></a>      <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>(<span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>]))<span class="op">/</span><span class="kw">exp</span>(<span class="kw">abs</span>(y)))) x[i]&lt;-y</span>
<span id="cb131-9"><a href="#cb131-9"></a>      <span class="cf">else</span>{</span>
<span id="cb131-10"><a href="#cb131-10"></a>         x[i]&lt;-x[i<span class="dv">-1</span>]</span>
<span id="cb131-11"><a href="#cb131-11"></a>      }</span>
<span id="cb131-12"><a href="#cb131-12"></a>   }</span>
<span id="cb131-13"><a href="#cb131-13"></a>   <span class="kw">return</span>(x)</span>
<span id="cb131-14"><a href="#cb131-14"></a>}</span>
<span id="cb131-15"><a href="#cb131-15"></a></span>
<span id="cb131-16"><a href="#cb131-16"></a><span class="co">## Rcpp function for Exercise 9.4</span></span>
<span id="cb131-17"><a href="#cb131-17"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb131-18"><a href="#cb131-18"></a><span class="kw">cppFunction</span>(<span class="st">&#39;NumericVector rwC(double sigma, int x0, int N) {</span></span>
<span id="cb131-19"><a href="#cb131-19"></a><span class="st">      NumericVector out(N);</span></span>
<span id="cb131-20"><a href="#cb131-20"></a><span class="st">      out[0] = x0;</span></span>
<span id="cb131-21"><a href="#cb131-21"></a><span class="st">      </span></span>
<span id="cb131-22"><a href="#cb131-22"></a><span class="st">      for(int i=1;i&lt;N;i++){</span></span>
<span id="cb131-23"><a href="#cb131-23"></a><span class="st">        double u = (double)rand() / RAND_MAX;</span></span>
<span id="cb131-24"><a href="#cb131-24"></a><span class="st">        </span></span>
<span id="cb131-25"><a href="#cb131-25"></a><span class="st">        double V1, V2, S;</span></span>
<span id="cb131-26"><a href="#cb131-26"></a><span class="st">        int phase = 0;</span></span>
<span id="cb131-27"><a href="#cb131-27"></a><span class="st">        double X;</span></span>
<span id="cb131-28"><a href="#cb131-28"></a><span class="st">     </span></span>
<span id="cb131-29"><a href="#cb131-29"></a><span class="st">        if ( phase == 0 ) {</span></span>
<span id="cb131-30"><a href="#cb131-30"></a><span class="st">         do {</span></span>
<span id="cb131-31"><a href="#cb131-31"></a><span class="st">            double U1 = (double)rand() / RAND_MAX;</span></span>
<span id="cb131-32"><a href="#cb131-32"></a><span class="st">            double U2 = (double)rand() / RAND_MAX;</span></span>
<span id="cb131-33"><a href="#cb131-33"></a><span class="st">             </span></span>
<span id="cb131-34"><a href="#cb131-34"></a><span class="st">            V1 = 2 * U1 - 1;</span></span>
<span id="cb131-35"><a href="#cb131-35"></a><span class="st">            V2 = 2 * U2 - 1;</span></span>
<span id="cb131-36"><a href="#cb131-36"></a><span class="st">            S = V1 * V1 + V2 * V2;</span></span>
<span id="cb131-37"><a href="#cb131-37"></a><span class="st">         } while(S &gt;= 1 || S == 0);</span></span>
<span id="cb131-38"><a href="#cb131-38"></a><span class="st">         </span></span>
<span id="cb131-39"><a href="#cb131-39"></a><span class="st">         X = V1 * sqrt(-2 * log(S) / S);</span></span>
<span id="cb131-40"><a href="#cb131-40"></a><span class="st">         } else</span></span>
<span id="cb131-41"><a href="#cb131-41"></a><span class="st">         X = V2 * sqrt(-2 * log(S) / S);</span></span>
<span id="cb131-42"><a href="#cb131-42"></a><span class="st">         </span></span>
<span id="cb131-43"><a href="#cb131-43"></a><span class="st">        phase = 1 - phase;</span></span>
<span id="cb131-44"><a href="#cb131-44"></a><span class="st">      </span></span>
<span id="cb131-45"><a href="#cb131-45"></a><span class="st">        double y = sigma*X+out[i-1];</span></span>
<span id="cb131-46"><a href="#cb131-46"></a><span class="st">        </span></span>
<span id="cb131-47"><a href="#cb131-47"></a><span class="st">        if(u &lt;= (exp(abs(out[i-1]))/exp(abs(y))))</span></span>
<span id="cb131-48"><a href="#cb131-48"></a><span class="st">           out[i] = y;</span></span>
<span id="cb131-49"><a href="#cb131-49"></a><span class="st">        else</span></span>
<span id="cb131-50"><a href="#cb131-50"></a><span class="st">           out[i] = out[i-1];</span></span>
<span id="cb131-51"><a href="#cb131-51"></a><span class="st">      }</span></span>
<span id="cb131-52"><a href="#cb131-52"></a><span class="st">      return out;</span></span>
<span id="cb131-53"><a href="#cb131-53"></a><span class="st">    }&#39;</span>)</span>
<span id="cb131-54"><a href="#cb131-54"></a></span>
<span id="cb131-55"><a href="#cb131-55"></a><span class="co">## initial values</span></span>
<span id="cb131-56"><a href="#cb131-56"></a>N&lt;-<span class="dv">2000</span></span>
<span id="cb131-57"><a href="#cb131-57"></a>sigma&lt;-<span class="dv">2</span></span>
<span id="cb131-58"><a href="#cb131-58"></a>x0&lt;-<span class="dv">20</span></span>
<span id="cb131-59"><a href="#cb131-59"></a></span>
<span id="cb131-60"><a href="#cb131-60"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb131-61"><a href="#cb131-61"></a>y1&lt;-<span class="kw">rwC</span>(sigma,x0,N)</span>
<span id="cb131-62"><a href="#cb131-62"></a>y2&lt;-<span class="kw">rw.Metropolis</span>(sigma,x0,N)</span>
<span id="cb131-63"><a href="#cb131-63"></a></span>
<span id="cb131-64"><a href="#cb131-64"></a><span class="co">## Compare the generated random numbers by the two functions using qqplot.</span></span>
<span id="cb131-65"><a href="#cb131-65"></a>a&lt;-<span class="kw">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb131-66"><a href="#cb131-66"></a>Q1&lt;-<span class="kw">quantile</span>(y1[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],a)</span>
<span id="cb131-67"><a href="#cb131-67"></a>Q2&lt;-<span class="kw">quantile</span>(y2[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],a)</span>
<span id="cb131-68"><a href="#cb131-68"></a><span class="kw">qqplot</span>(Q1,Q2,<span class="dt">xlab=</span><span class="st">&quot;Rcpp function quantiles&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;R function quantiles&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="co">## Compare the computation time of the two functions with microbenchmark.</span></span>
<span id="cb132-2"><a href="#cb132-2"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 3.6.2</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">rw.Metropolis</span>(sigma,x0,N),<span class="dt">rwRcpp=</span><span class="kw">rwC</span>(sigma,x0,N))</span>
<span id="cb134-2"><a href="#cb134-2"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr     lq  median      uq
## 1    rwR 4254.1 4357.15 4676.75
## 2 rwRcpp  351.3  361.95  384.65</code></pre>
<p>From the results, we can find that the Rcpp function greatly decreases the computation time.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
